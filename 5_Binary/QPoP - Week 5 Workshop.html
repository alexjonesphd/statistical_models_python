
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>5 - Binary outcome models &#8212; Statistical Modelling with Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '5_Binary/QPoP - Week 5 Workshop';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Using and understanding probit models - Exercises &amp; Answers" href="QPoP%20-%20Week%205%20Exercises%20-%20Answers.html" />
    <link rel="prev" title="Asking scientific questions of models - Exercises &amp; Answers" href="../4_Prediction/QPoP%20-%20Week%204%20Exercises%20-%20Answers.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Statistical Modelling with Python - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Statistical Modelling with Python - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Statistical Modelling with Python
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Python Basics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../1_Introduction/QPoP%20-%20Week%201%20Workshop.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_Introduction/QPoP%20-%20Week%201%20Exercises%20-%20Answers.html">Using Python for Data Analysis - Exercises &amp; Answers</a></li>






</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">The GLM</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../2_The_GLM/QPoP%20-%20Week%202%20Workshop.html">2 - The General Linear Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_The_GLM/QPoP%20-%20Week%202%20Exercises%20-%20Answers.html">Getting to grips with linear models in Python - Exercises &amp; Answers</a></li>



</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Advancing the GLM</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../3_Advancing_GLM/QPoP%20-%20Week%203%20Workshop.html">3 - Advancing the general linear model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_Advancing_GLM/QPoP%20-%20Week%203%20Exercises%20-%20Answers.html">Checking assumptions and including interactions - Exercises &amp; Answers</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">The art of prediction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../4_Prediction/QPoP%20-%20Week%204%20Workshop.html">4 - The art of prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_Prediction/QPoP%20-%20Week%204%20Exercises%20-%20Answers.html">Asking scientific questions of models - Exercises &amp; Answers</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Binary outcome models</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">5 - Binary outcome models</a></li>
<li class="toctree-l1"><a class="reference internal" href="QPoP%20-%20Week%205%20Exercises%20-%20Answers.html">Using and understanding probit models - Exercises &amp; Answers</a></li>



</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Applications and other kinds of hypotheses</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../6_Applications/QPoP%20-%20Week%206%20Workshop.html">6 - Precision in Predictions</a></li>




<li class="toctree-l1"><a class="reference internal" href="../6_Applications/QPoP%20-%20Week%206%20Exercises%20-%20Answers.html">Quantitative Perspectives on Psychology</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Linear Mixed Effects Models</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../7_MixedModel/QPoP%20-%20Week%207%20Workshop.html">7 - Linear mixed effects models</a></li>

</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2F5_Binary/QPoP - Week 5 Workshop.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/5_Binary/QPoP - Week 5 Workshop.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>5 - Binary outcome models</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dealing-with-non-continuous-outcomes">Dealing with non-continuous outcomes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#probit-regression">Probit regression</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dichotomising-data">Dichotomising data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-a-model-and-making-predictions">Fitting a model and making predictions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#checking-fit-and-other-statistics">Checking fit and other statistics</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-log-likelihood-statistic">The log-likelihood statistic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-phi-coefficient">The phi coefficient</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-confusion-matrix">The confusion matrix</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#building-complexity-in-a-probit-model">Building complexity in a probit model</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="binary-outcome-models">
<h1>5 - Binary outcome models<a class="headerlink" href="#binary-outcome-models" title="Link to this heading">#</a></h1>
<section id="dealing-with-non-continuous-outcomes">
<h2>Dealing with non-continuous outcomes<a class="headerlink" href="#dealing-with-non-continuous-outcomes" title="Link to this heading">#</a></h2>
<p>This week we expand our linear model knowledge to deal with binary outcomes. That is - sticking to the mantra of ‘all models are wrong, but some are useful’, how can we best model and understand data that only ever takes on one of two values?</p>
</section>
<section id="probit-regression">
<h2>Probit regression<a class="headerlink" href="#probit-regression" title="Link to this heading">#</a></h2>
<p>Probit regression solves this problem. Many of the same skills used for the GLM apply here, so we will spend some time fitting probit models using <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>, examining their probabilistic predictions with <code class="docutils literal notranslate"><span class="pre">marginaleffects</span></code>, and calculating some of thei varied statistics with other tools.</p>
<p>Lets import everything we need for now:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import most of what we need</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> <span class="c1"># dataframes</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span> <span class="c1"># plots</span>
<span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span> <span class="c1"># Models</span>
<span class="kn">import</span> <span class="nn">marginaleffects</span> <span class="k">as</span> <span class="nn">me</span> <span class="c1"># marginal effects</span>

<span class="c1"># Set the style for plots</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;ticks&#39;</span><span class="p">)</span> <span class="c1"># a different theme!</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">&#39;talk&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="dichotomising-data">
<h2>Dichotomising data<a class="headerlink" href="#dichotomising-data" title="Link to this heading">#</a></h2>
<p>We will continue the example of working with the <code class="docutils literal notranslate"><span class="pre">affairs</span></code> dataset, but this time focusing on a binary outcome. First, we will load the dataset, and observe that the <code class="docutils literal notranslate"><span class="pre">affair</span></code> column has multiple distinct values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First read in the data</span>
<span class="n">affairs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://vincentarelbundock.github.io/Rdatasets/csv/AER/Affairs.csv&#39;</span><span class="p">)</span>

<span class="c1"># Show top 3</span>
<span class="n">display</span><span class="p">(</span><span class="n">affairs</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>

<span class="c1"># Show the unique values in the affair columns</span>
<span class="nb">print</span><span class="p">(</span><span class="n">affairs</span><span class="p">[</span><span class="s1">&#39;affairs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rownames</th>
      <th>affairs</th>
      <th>gender</th>
      <th>age</th>
      <th>yearsmarried</th>
      <th>children</th>
      <th>religiousness</th>
      <th>education</th>
      <th>occupation</th>
      <th>rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>0</td>
      <td>male</td>
      <td>37.0</td>
      <td>10.0</td>
      <td>no</td>
      <td>3</td>
      <td>18</td>
      <td>7</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5</td>
      <td>0</td>
      <td>female</td>
      <td>27.0</td>
      <td>4.0</td>
      <td>no</td>
      <td>4</td>
      <td>14</td>
      <td>6</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11</td>
      <td>0</td>
      <td>female</td>
      <td>32.0</td>
      <td>15.0</td>
      <td>yes</td>
      <td>1</td>
      <td>12</td>
      <td>1</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>affairs
0     451
7      42
12     38
1      34
3      19
2      17
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>This suggests the majoirty of people have not had an affair, while a minority have had one or more. To use a probit regression here - to predict whether someone has, or has not, then we need to dichotomise the variable and put it back into the dataframe.</p>
<p>A quick way of doing this is to borrow a function from a package called <code class="docutils literal notranslate"><span class="pre">numpy</span></code>, called <code class="docutils literal notranslate"><span class="pre">digitize</span></code>. This takes a column of a dataframe and a list of thresholds, and recodes the data such that equal to the threshold or more gets replaced with that value.</p>
<p>Lets import <code class="docutils literal notranslate"><span class="pre">numpy</span></code> and recode the <code class="docutils literal notranslate"><span class="pre">affairs</span></code> column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import numpy with alias</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Digitise the affairs column for 1 or more, put into a new column in the dataframe</span>
<span class="c1">#affairs[&#39;affairyes&#39;] = np.digitize(affairs[&#39;affairs&#39;], [1])</span>
<span class="n">affairs</span><span class="p">[</span><span class="s1">&#39;affairyes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">affairs</span><span class="p">[</span><span class="s1">&#39;affairs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># Scatter</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pointplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">affairs</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;affairs&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;affairyes&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;affairs&#39;, ylabel=&#39;affairyes&#39;&gt;
</pre></div>
</div>
<img alt="../_images/5efe12a01c4462e2ffdf8352252e52c43bb52c976ee7e3691c3db448ec59ba42.png" src="../_images/5efe12a01c4462e2ffdf8352252e52c43bb52c976ee7e3691c3db448ec59ba42.png" />
</div>
</div>
</section>
<section id="fitting-a-model-and-making-predictions">
<h2>Fitting a model and making predictions<a class="headerlink" href="#fitting-a-model-and-making-predictions" title="Link to this heading">#</a></h2>
<p>With the new dichomotised variable, fitting a model is as simple as using <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> to use <code class="docutils literal notranslate"><span class="pre">probit</span></code> instead of <code class="docutils literal notranslate"><span class="pre">ols</span></code>.</p>
<p>Below we predict occurrence of an affair from marriage rating, children, and years of marriage.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fitting a probit model</span>
<span class="n">probit_model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">probit</span><span class="p">(</span><span class="s1">&#39;affairyes ~ rating + yearsmarried + children&#39;</span><span class="p">,</span>
                          <span class="n">data</span><span class="o">=</span><span class="n">affairs</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1"># Show summary</span>
<span class="n">probit_model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimization terminated successfully.
         Current function value: 0.525523
         Iterations 5
</pre></div>
</div>
<div class="output text_html"><table class="simpletable">
<caption>Probit Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>       <td>affairyes</td>    <th>  No. Observations:  </th>  <td>   601</td>  
</tr>
<tr>
  <th>Model:</th>                <td>Probit</td>      <th>  Df Residuals:      </th>  <td>   597</td>  
</tr>
<tr>
  <th>Method:</th>                 <td>MLE</td>       <th>  Df Model:          </th>  <td>     3</td>  
</tr>
<tr>
  <th>Date:</th>            <td>Wed, 02 Oct 2024</td> <th>  Pseudo R-squ.:     </th>  <td>0.06470</td> 
</tr>
<tr>
  <th>Time:</th>                <td>14:57:20</td>     <th>  Log-Likelihood:    </th> <td> -315.84</td> 
</tr>
<tr>
  <th>converged:</th>             <td>True</td>       <th>  LL-Null:           </th> <td> -337.69</td> 
</tr>
<tr>
  <th>Covariance Type:</th>     <td>nonrobust</td>    <th>  LLR p-value:       </th> <td>1.749e-09</td>
</tr>
</table>
<table class="simpletable">
<tr>
         <td></td>            <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>       <td>    0.0852</td> <td>    0.252</td> <td>    0.338</td> <td> 0.735</td> <td>   -0.409</td> <td>    0.579</td>
</tr>
<tr>
  <th>children[T.yes]</th> <td>    0.2243</td> <td>    0.160</td> <td>    1.404</td> <td> 0.160</td> <td>   -0.089</td> <td>    0.538</td>
</tr>
<tr>
  <th>rating</th>          <td>   -0.2739</td> <td>    0.052</td> <td>   -5.299</td> <td> 0.000</td> <td>   -0.375</td> <td>   -0.173</td>
</tr>
<tr>
  <th>yearsmarried</th>    <td>    0.0136</td> <td>    0.012</td> <td>    1.088</td> <td> 0.277</td> <td>   -0.011</td> <td>    0.038</td>
</tr>
</table></div></div>
</div>
<p>We can <em>roughly</em> interpret this outcome along the lines of those who are happier in their marriage move lower down the unobserved ‘tendency to engage in an affair’ variable, i.e., it reduces their probability of an affair. But by how much requires examining predictions - reasoning about coefficients in the GLM is hard, but with probit models it is even harder.</p>
<p>Luckily, <code class="docutils literal notranslate"><span class="pre">marginaleffects</span></code> works exactly the same way. Lets have the model predict the probabilities of an affair for individuals with each level of marital satisfaction, just like with the GLM:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Predictions</span>
<span class="n">predict_for</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">datagrid</span><span class="p">(</span><span class="n">probit_model</span><span class="p">,</span>
                          <span class="n">rating</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>

<span class="c1"># Predictions</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">predictions</span><span class="p">(</span><span class="n">probit_model</span><span class="p">,</span> 
                             <span class="n">newdata</span><span class="o">=</span><span class="n">predict_for</span><span class="p">)</span>

<span class="c1"># Display</span>
<span class="n">display</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 19)</small><table border="1" class="dataframe"><thead><tr><th>rating</th><th>rowid</th><th>estimate</th><th>std_error</th><th>statistic</th><th>p_value</th><th>s_value</th><th>conf_low</th><th>conf_high</th><th>rownames</th><th>affairs</th><th>gender</th><th>age</th><th>yearsmarried</th><th>children</th><th>religiousness</th><th>education</th><th>occupation</th><th>affairyes</th></tr><tr><td>i64</td><td>i32</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>i64</td><td>i64</td><td>str</td><td>f64</td><td>f64</td><td>str</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td></tr></thead><tbody><tr><td>1</td><td>0</td><td>0.55826</td><td>0.062539</td><td>8.926567</td><td>0.0</td><td>inf</td><td>0.435685</td><td>0.680834</td><td>1752</td><td>0</td><td>&quot;female&quot;</td><td>32.487521</td><td>8.177696</td><td>&quot;yes&quot;</td><td>4</td><td>14</td><td>5</td><td>0</td></tr><tr><td>2</td><td>1</td><td>0.449339</td><td>0.045342</td><td>9.910018</td><td>0.0</td><td>inf</td><td>0.360471</td><td>0.538208</td><td>1752</td><td>0</td><td>&quot;female&quot;</td><td>32.487521</td><td>8.177696</td><td>&quot;yes&quot;</td><td>4</td><td>14</td><td>5</td><td>0</td></tr><tr><td>3</td><td>2</td><td>0.344129</td><td>0.029661</td><td>11.602137</td><td>0.0</td><td>inf</td><td>0.285995</td><td>0.402263</td><td>1752</td><td>0</td><td>&quot;female&quot;</td><td>32.487521</td><td>8.177696</td><td>&quot;yes&quot;</td><td>4</td><td>14</td><td>5</td><td>0</td></tr><tr><td>4</td><td>3</td><td>0.249803</td><td>0.022909</td><td>10.904162</td><td>0.0</td><td>inf</td><td>0.204902</td><td>0.294703</td><td>1752</td><td>0</td><td>&quot;female&quot;</td><td>32.487521</td><td>8.177696</td><td>&quot;yes&quot;</td><td>4</td><td>14</td><td>5</td><td>0</td></tr><tr><td>5</td><td>4</td><td>0.17131</td><td>0.024463</td><td>7.002925</td><td>2.5067e-12</td><td>38.53737</td><td>0.123364</td><td>0.219256</td><td>1752</td><td>0</td><td>&quot;female&quot;</td><td>32.487521</td><td>8.177696</td><td>&quot;yes&quot;</td><td>4</td><td>14</td><td>5</td><td>0</td></tr></tbody></table></div></div></div>
</div>
<p>If we plot this we see the slightly non-linear relationship:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">predictions</span><span class="p">,</span>
                  <span class="n">x</span><span class="o">=</span><span class="s1">&#39;rating&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;estimate&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Predicted probability of affair&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Text(0, 0.5, &#39;Predicted probability of affair&#39;)]
</pre></div>
</div>
<img alt="../_images/1956e46c8c7d96a653aad10d49cb8b0dee0d7e57af28a93052d062e8ac3c5587.png" src="../_images/1956e46c8c7d96a653aad10d49cb8b0dee0d7e57af28a93052d062e8ac3c5587.png" />
</div>
</div>
<p>The predictions work in the same fashion as the GLM. For example, we can ask whether those with the highest satisfaction of 5 are less likely to have an affair than those with a 4:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Contrast a 4 and 5</span>
<span class="n">me</span><span class="o">.</span><span class="n">predictions</span><span class="p">(</span><span class="n">probit_model</span><span class="p">,</span> 
               <span class="n">newdata</span><span class="o">=</span><span class="n">me</span><span class="o">.</span><span class="n">datagrid</span><span class="p">(</span><span class="n">rating</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span>
               <span class="n">hypothesis</span><span class="o">=</span><span class="s1">&#39;pairwise&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (1, 8)</small><table border="1" class="dataframe"><thead><tr><th>term</th><th>estimate</th><th>std_error</th><th>statistic</th><th>p_value</th><th>s_value</th><th>conf_low</th><th>conf_high</th></tr><tr><td>str</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>&quot;Row 1 - Row 2&quot;</td><td>-0.078493</td><td>0.013093</td><td>-5.995016</td><td>2.0347e-9</td><td>28.872566</td><td>-0.104154</td><td>-0.052831</td></tr></tbody></table></div></div></div>
</div>
<p>Those with a satisfaction of 5 have a lower probability of engaging in an affair of about 8 points, which is statistically significant. Notice how this number is totally divorced from the coefficients - in a GLM there would be <em>some</em> correspondence, but here, the predictions are absolutely essential.</p>
<p>As a further example, consider the difference between those with a 1 and 2 on the satisfaction scale:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Contrast a 1 and 2</span>
<span class="n">me</span><span class="o">.</span><span class="n">predictions</span><span class="p">(</span><span class="n">probit_model</span><span class="p">,</span> 
               <span class="n">newdata</span><span class="o">=</span><span class="n">me</span><span class="o">.</span><span class="n">datagrid</span><span class="p">(</span><span class="n">rating</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
               <span class="n">hypothesis</span><span class="o">=</span><span class="s1">&#39;pairwise&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (1, 8)</small><table border="1" class="dataframe"><thead><tr><th>term</th><th>estimate</th><th>std_error</th><th>statistic</th><th>p_value</th><th>s_value</th><th>conf_low</th><th>conf_high</th></tr><tr><td>str</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>&quot;Row 1 - Row 2&quot;</td><td>-0.108921</td><td>0.020308</td><td>-5.363511</td><td>8.1620e-8</td><td>23.546511</td><td>-0.148723</td><td>-0.069118</td></tr></tbody></table></div></div></div>
</div>
<p>This is around 11 points - this is <strong>not</strong> the same as the 5 - 4 difference, which it would be in a GLM, because they are absolutely linear, while these models are not! The distinction is subtle but vital in interpretation, but since we are used to dealing with predictions, we need not worry.</p>
</section>
<section id="checking-fit-and-other-statistics">
<h2>Checking fit and other statistics<a class="headerlink" href="#checking-fit-and-other-statistics" title="Link to this heading">#</a></h2>
<p>Lets see how to examine a range of statistics related to the fit of a probit model.</p>
<section id="the-log-likelihood-statistic">
<h3>The log-likelihood statistic<a class="headerlink" href="#the-log-likelihood-statistic" title="Link to this heading">#</a></h3>
<p>First, the log-likelihood statistic, which shows us whether the predictors improve the predictions over a model with no predictors. This is stored in the <code class="docutils literal notranslate"><span class="pre">.summary()</span></code> output - a value closer to zero is better:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show summary, just first table</span>
<span class="n">probit_model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>Probit Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>       <td>affairyes</td>    <th>  No. Observations:  </th>  <td>   601</td>  
</tr>
<tr>
  <th>Model:</th>                <td>Probit</td>      <th>  Df Residuals:      </th>  <td>   597</td>  
</tr>
<tr>
  <th>Method:</th>                 <td>MLE</td>       <th>  Df Model:          </th>  <td>     3</td>  
</tr>
<tr>
  <th>Date:</th>            <td>Wed, 02 Oct 2024</td> <th>  Pseudo R-squ.:     </th>  <td>0.06470</td> 
</tr>
<tr>
  <th>Time:</th>                <td>14:57:20</td>     <th>  Log-Likelihood:    </th> <td> -315.84</td> 
</tr>
<tr>
  <th>converged:</th>             <td>True</td>       <th>  LL-Null:           </th> <td> -337.69</td> 
</tr>
<tr>
  <th>Covariance Type:</th>     <td>nonrobust</td>    <th>  LLR p-value:       </th> <td>1.749e-09</td>
</tr>
</table></div></div>
</div>
<p>This is significant, offering us a coarse measure that our predictors, at least, aren’t making things worse!</p>
</section>
<section id="the-phi-coefficient">
<h3>The phi coefficient<a class="headerlink" href="#the-phi-coefficient" title="Link to this heading">#</a></h3>
<p>This is the correlation between the observed values and predicted <em>binary</em> values. This takes a little bit of work to obtain, with the following steps:</p>
<ul class="simple">
<li><p>Obtain the predicted probabilities of each datapoint</p></li>
<li><p>Convert them to 0 and 1 depending on whether they are below or above .5</p></li>
<li><p>Correlate them with the observed data, using the <code class="docutils literal notranslate"><span class="pre">corr</span></code> function from <code class="docutils literal notranslate"><span class="pre">pingouin</span></code>.</p></li>
</ul>
<p>We can do this in a few steps, relying on <code class="docutils literal notranslate"><span class="pre">marginaleffects</span></code> and the handy <code class="docutils literal notranslate"><span class="pre">np.digitize</span></code> function.</p>
<p>First, get the predictions for each data point, then dichotomise them.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First make a prediction on the whole dataset, like so</span>
<span class="n">all_predictions</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">predictions</span><span class="p">(</span><span class="n">probit_model</span><span class="p">)</span> 
<span class="c1"># notice there&#39;s nothing else here bar the model</span>

<span class="c1"># Digitize with .5 as the threshold</span>
<span class="n">binary_predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">digitize</span><span class="p">(</span><span class="n">all_predictions</span><span class="p">[</span><span class="s1">&#39;estimate&#39;</span><span class="p">],</span>
                                 <span class="p">[</span><span class="mf">0.5</span><span class="p">])</span>

<span class="c1"># Plot</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">all_predictions</span><span class="p">[</span><span class="s1">&#39;estimate&#39;</span><span class="p">],</span>
                     <span class="n">y</span><span class="o">=</span><span class="n">binary_predictions</span><span class="p">,</span>
                     <span class="n">alpha</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">yticks</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Predicted Affair Status&#39;</span><span class="p">,</span>
       <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Predicted Probability of Affair&#39;</span><span class="p">)</span>
       
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[&lt;matplotlib.axis.YTick at 0x14e74a850&gt;,
  &lt;matplotlib.axis.YTick at 0x14e748b10&gt;],
 Text(0, 0.5, &#39;Predicted Affair Status&#39;),
 Text(0.5, 0, &#39;Predicted Probability of Affair&#39;)]
</pre></div>
</div>
<img alt="../_images/3e2eb8b99396614ef1ba9818bbdee857b3922882dfcb93e7af20465874a465d8.png" src="../_images/3e2eb8b99396614ef1ba9818bbdee857b3922882dfcb93e7af20465874a465d8.png" />
</div>
</div>
<p>Next, we import <code class="docutils literal notranslate"><span class="pre">pingouin</span></code> and carry out the correlation between the observed and actual values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import pingouin</span>
<span class="kn">import</span> <span class="nn">pingouin</span> <span class="k">as</span> <span class="nn">pg</span>

<span class="c1"># Correlate</span>
<span class="n">pg</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">affairs</span><span class="p">[</span><span class="s1">&#39;affairyes&#39;</span><span class="p">],</span>
        <span class="n">binary_predictions</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>n</th>
      <th>r</th>
      <th>CI95%</th>
      <th>p-val</th>
      <th>BF10</th>
      <th>power</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>pearson</th>
      <td>601</td>
      <td>0.080253</td>
      <td>[0.0, 0.16]</td>
      <td>0.04924</td>
      <td>0.352</td>
      <td>0.503309</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Note the barely significant correlation here. The phi coefficient is not too promising, despite the other statistics!</p>
</section>
</section>
<section id="the-confusion-matrix">
<h2>The confusion matrix<a class="headerlink" href="#the-confusion-matrix" title="Link to this heading">#</a></h2>
<p>Now we have the binary predictions in hand, we can build the <strong>confusion matrix</strong> that lets us interpret the <em>types</em> of predictions the model has made. We can rely on <code class="docutils literal notranslate"><span class="pre">pandas</span></code> to help us figure this out, using the <code class="docutils literal notranslate"><span class="pre">pd.crosstab</span></code> function, which will neatly tabulate our results. All it needs is the actual data, and the predicted data, like so:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Crosstabs</span>
<span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">affairs</span><span class="p">[</span><span class="s1">&#39;affairyes&#39;</span><span class="p">],</span>
            <span class="n">binary_predictions</span><span class="p">,</span>
            <span class="n">rownames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Observed&#39;</span><span class="p">],</span> <span class="c1"># labels the rows</span>
            <span class="n">colnames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Predicted&#39;</span><span class="p">],</span> <span class="c1"># labels the columns</span>
            <span class="n">margins</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># calculates the totals across rows and columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Predicted</th>
      <th>0</th>
      <th>1</th>
      <th>All</th>
    </tr>
    <tr>
      <th>Observed</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>443</td>
      <td>8</td>
      <td>451</td>
    </tr>
    <tr>
      <th>1</th>
      <td>143</td>
      <td>7</td>
      <td>150</td>
    </tr>
    <tr>
      <th>All</th>
      <td>586</td>
      <td>15</td>
      <td>601</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can now see the explanation for the low phi coefficient. The model is making a lot of <em>false negative</em> predictions. That is, it is labelling those who have had an affair (150 in the data) as not having done so - out of the 150 who have, it thinks 143 did <em>not</em>, and only gets 7 correct!</p>
<p>So as to dispel confusion about confusion matrices, here are the kinds of predictions this model has made:</p>
<ul class="simple">
<li><p><strong>True negatives</strong> - The model correctly predicted 0 for 443 people who did not have an affair, out of 451 who did not.</p></li>
<li><p><strong>True positives</strong> - the model correctly predicted 1 for 7 people who did have an affair, out of 150 who did.</p></li>
<li><p><strong>False negatives</strong> - the model incorrectly predicted 0 for 143 who did have an affair, out of the 150 who did.</p></li>
<li><p><strong>False positives</strong> - the model incorrectly predicted 1 for 8 people who did not have an affair, out of the 451 who did.</p></li>
</ul>
<p>For a model designed to predict those who might engage in an affair, this is not great!</p>
</section>
<section id="building-complexity-in-a-probit-model">
<h2>Building complexity in a probit model<a class="headerlink" href="#building-complexity-in-a-probit-model" title="Link to this heading">#</a></h2>
<p>Having evaluated the model and found it lacking, lets try to improve it. One clear way is to increase the complexity by adding in interactions.</p>
<p>Here we test a model that has a more complex story. We adjust for marital satisfaction ratings, but we include an interaction between years married, child status, and gender. This supposes that the propensity of an affair alters for how long a couple has been married and their child status, and that this pattern may be different for males and females.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fitting a probit model</span>
<span class="n">probit_model2</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">probit</span><span class="p">(</span><span class="s1">&#39;affairyes ~ rating + yearsmarried * children * gender&#39;</span><span class="p">,</span>
                          <span class="n">data</span><span class="o">=</span><span class="n">affairs</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1"># Show summary</span>
<span class="n">probit_model2</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimization terminated successfully.
         Current function value: 0.518543
         Iterations 6
</pre></div>
</div>
<div class="output text_html"><table class="simpletable">
<caption>Probit Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>       <td>affairyes</td>    <th>  No. Observations:  </th>  <td>   601</td>  
</tr>
<tr>
  <th>Model:</th>                <td>Probit</td>      <th>  Df Residuals:      </th>  <td>   592</td>  
</tr>
<tr>
  <th>Method:</th>                 <td>MLE</td>       <th>  Df Model:          </th>  <td>     8</td>  
</tr>
<tr>
  <th>Date:</th>            <td>Wed, 02 Oct 2024</td> <th>  Pseudo R-squ.:     </th>  <td>0.07713</td> 
</tr>
<tr>
  <th>Time:</th>                <td>14:57:20</td>     <th>  Log-Likelihood:    </th> <td> -311.64</td> 
</tr>
<tr>
  <th>converged:</th>             <td>True</td>       <th>  LL-Null:           </th> <td> -337.69</td> 
</tr>
<tr>
  <th>Covariance Type:</th>     <td>nonrobust</td>    <th>  LLR p-value:       </th> <td>1.618e-08</td>
</tr>
</table>
<table class="simpletable">
<tr>
                       <td></td>                          <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>                                   <td>   -0.4448</td> <td>    0.340</td> <td>   -1.308</td> <td> 0.191</td> <td>   -1.111</td> <td>    0.222</td>
</tr>
<tr>
  <th>children[T.yes]</th>                             <td>    0.8571</td> <td>    0.340</td> <td>    2.522</td> <td> 0.012</td> <td>    0.191</td> <td>    1.523</td>
</tr>
<tr>
  <th>gender[T.male]</th>                              <td>    0.5388</td> <td>    0.350</td> <td>    1.541</td> <td> 0.123</td> <td>   -0.147</td> <td>    1.224</td>
</tr>
<tr>
  <th>children[T.yes]:gender[T.male]</th>              <td>   -0.5331</td> <td>    0.464</td> <td>   -1.148</td> <td> 0.251</td> <td>   -1.443</td> <td>    0.377</td>
</tr>
<tr>
  <th>rating</th>                                      <td>   -0.2698</td> <td>    0.052</td> <td>   -5.158</td> <td> 0.000</td> <td>   -0.372</td> <td>   -0.167</td>
</tr>
<tr>
  <th>yearsmarried</th>                                <td>    0.1327</td> <td>    0.052</td> <td>    2.540</td> <td> 0.011</td> <td>    0.030</td> <td>    0.235</td>
</tr>
<tr>
  <th>yearsmarried:children[T.yes]</th>                <td>   -0.1350</td> <td>    0.056</td> <td>   -2.421</td> <td> 0.015</td> <td>   -0.244</td> <td>   -0.026</td>
</tr>
<tr>
  <th>yearsmarried:gender[T.male]</th>                 <td>   -0.0922</td> <td>    0.065</td> <td>   -1.412</td> <td> 0.158</td> <td>   -0.220</td> <td>    0.036</td>
</tr>
<tr>
  <th>yearsmarried:children[T.yes]:gender[T.male]</th> <td>    0.1008</td> <td>    0.071</td> <td>    1.429</td> <td> 0.153</td> <td>   -0.037</td> <td>    0.239</td>
</tr>
</table></div></div>
</div>
<p>A few coefficients, including part of the interaction, are significant, and the log-likelihood ratio test is also.</p>
<p>Let’s make sense of this interaction step-by-step. First, we will generate and plot the predictions for a range of candidate years of marriage, for those with and without children, and for females and males:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot predictions</span>
<span class="n">predict_this</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">datagrid</span><span class="p">(</span><span class="n">probit_model2</span><span class="p">,</span>
                           <span class="n">yearsmarried</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="c1"># generates numbers 1 to 25</span>
                           <span class="n">children</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;no&#39;</span><span class="p">],</span>
                           <span class="n">gender</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;male&#39;</span><span class="p">,</span> <span class="s1">&#39;female&#39;</span><span class="p">])</span>

<span class="c1"># Get probabilities!</span>
<span class="n">probs</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">predictions</span><span class="p">(</span><span class="n">probit_model2</span><span class="p">,</span> 
                       <span class="n">newdata</span><span class="o">=</span><span class="n">predict_this</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">relplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">probs</span><span class="p">,</span>
                <span class="n">x</span><span class="o">=</span><span class="s1">&#39;yearsmarried&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;estimate&#39;</span><span class="p">,</span>
                <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;children&#39;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s1">&#39;gender&#39;</span><span class="p">,</span>
                <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;line&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">refline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_ylabels</span><span class="p">(</span><span class="s1">&#39;Predicted Probability of an Affair&#39;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_xlabels</span><span class="p">(</span><span class="s1">&#39;Years Married&#39;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xticks</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.FacetGrid at 0x14ef6ced0&gt;
</pre></div>
</div>
<img alt="../_images/fddf0bb3c21579f4c2f7afde8bbf4166a3f181bc732efdb24d85e87a80dd12ec.png" src="../_images/fddf0bb3c21579f4c2f7afde8bbf4166a3f181bc732efdb24d85e87a80dd12ec.png" />
</div>
</div>
<p>This suggests that while males and females <em>with</em> children have more or less a constant probability of an affair across their marriage duration, there is an increase in probabilities for those without children, and particularly for females.</p>
<p>We can explore this further by examining the slopes of years married for females and males, with and without children:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Slopes</span>
<span class="n">me</span><span class="o">.</span><span class="n">slopes</span><span class="p">(</span><span class="n">probit_model2</span><span class="p">,</span>
          <span class="n">newdata</span><span class="o">=</span><span class="n">predict_this</span><span class="p">,</span>
          <span class="n">variables</span><span class="o">=</span><span class="s1">&#39;yearsmarried&#39;</span><span class="p">,</span>
          <span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">,</span> <span class="s1">&#39;children&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (4, 11)</small><table border="1" class="dataframe"><thead><tr><th>children</th><th>gender</th><th>term</th><th>contrast</th><th>estimate</th><th>std_error</th><th>statistic</th><th>p_value</th><th>s_value</th><th>conf_low</th><th>conf_high</th></tr><tr><td>str</td><td>str</td><td>str</td><td>str</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>&quot;no&quot;</td><td>&quot;female&quot;</td><td>&quot;yearsmarried&quot;</td><td>&quot;mean(dY/dX)&quot;</td><td>0.0369</td><td>0.006906</td><td>5.343087</td><td>9.1377e-8</td><td>23.383592</td><td>0.023364</td><td>0.050436</td></tr><tr><td>&quot;yes&quot;</td><td>&quot;female&quot;</td><td>&quot;yearsmarried&quot;</td><td>&quot;mean(dY/dX)&quot;</td><td>-0.000573</td><td>0.004898</td><td>-0.11705</td><td>0.90682</td><td>0.141111</td><td>-0.010172</td><td>0.009026</td></tr><tr><td>&quot;no&quot;</td><td>&quot;male&quot;</td><td>&quot;yearsmarried&quot;</td><td>&quot;mean(dY/dX)&quot;</td><td>0.011999</td><td>0.013958</td><td>0.859613</td><td>0.390002</td><td>1.358445</td><td>-0.015359</td><td>0.039356</td></tr><tr><td>&quot;yes&quot;</td><td>&quot;male&quot;</td><td>&quot;yearsmarried&quot;</td><td>&quot;mean(dY/dX)&quot;</td><td>0.001757</td><td>0.005161</td><td>0.340349</td><td>0.733593</td><td>0.446947</td><td>-0.00836</td><td>0.011873</td></tr></tbody></table></div></div></div>
</div>
<p>These demonstrate the slope (at its maximum point) for each combination of male, female, and child status.</p>
<p>We can then test the hypotheses about whether these slopes are different using <code class="docutils literal notranslate"><span class="pre">hypothesis</span></code> methods. Is there a higher slope for females without children than with?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First hypothesis</span>
<span class="n">me</span><span class="o">.</span><span class="n">slopes</span><span class="p">(</span><span class="n">probit_model2</span><span class="p">,</span>
          <span class="n">newdata</span><span class="o">=</span><span class="n">predict_this</span><span class="p">,</span>
          <span class="n">variables</span><span class="o">=</span><span class="s1">&#39;yearsmarried&#39;</span><span class="p">,</span>
          <span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">,</span> <span class="s1">&#39;children&#39;</span><span class="p">],</span>
          <span class="n">hypothesis</span><span class="o">=</span><span class="s1">&#39;b1=b2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (1, 8)</small><table border="1" class="dataframe"><thead><tr><th>term</th><th>estimate</th><th>std_error</th><th>statistic</th><th>p_value</th><th>s_value</th><th>conf_low</th><th>conf_high</th></tr><tr><td>str</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>&quot;b1=b2&quot;</td><td>0.037474</td><td>0.008454</td><td>4.432489</td><td>0.000009</td><td>16.711988</td><td>0.020903</td><td>0.054044</td></tr></tbody></table></div></div></div>
</div>
<p>And for males:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Second hypothesis</span>
<span class="n">me</span><span class="o">.</span><span class="n">slopes</span><span class="p">(</span><span class="n">probit_model2</span><span class="p">,</span>
          <span class="n">newdata</span><span class="o">=</span><span class="n">predict_this</span><span class="p">,</span>
          <span class="n">variables</span><span class="o">=</span><span class="s1">&#39;yearsmarried&#39;</span><span class="p">,</span>
          <span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">,</span> <span class="s1">&#39;children&#39;</span><span class="p">],</span>
          <span class="n">hypothesis</span><span class="o">=</span><span class="s1">&#39;b3=b4&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (1, 8)</small><table border="1" class="dataframe"><thead><tr><th>term</th><th>estimate</th><th>std_error</th><th>statistic</th><th>p_value</th><th>s_value</th><th>conf_low</th><th>conf_high</th></tr><tr><td>str</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>&quot;b3=b4&quot;</td><td>0.010242</td><td>0.014848</td><td>0.689767</td><td>0.49034</td><td>1.028144</td><td>-0.01886</td><td>0.039344</td></tr></tbody></table></div></div></div>
</div>
<p>So an effect for females, not for males. Is the difference in these differences significant?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compound hypothesis</span>
<span class="n">me</span><span class="o">.</span><span class="n">slopes</span><span class="p">(</span><span class="n">probit_model2</span><span class="p">,</span>
          <span class="n">newdata</span><span class="o">=</span><span class="n">predict_this</span><span class="p">,</span>
          <span class="n">variables</span><span class="o">=</span><span class="s1">&#39;yearsmarried&#39;</span><span class="p">,</span>
          <span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">,</span> <span class="s1">&#39;children&#39;</span><span class="p">],</span>
          <span class="n">hypothesis</span><span class="o">=</span><span class="s1">&#39;b1-b2 = b3-b4&#39;</span><span class="p">)</span> <span class="c1"># Females No - Yes = Male No - Yes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (1, 8)</small><table border="1" class="dataframe"><thead><tr><th>term</th><th>estimate</th><th>std_error</th><th>statistic</th><th>p_value</th><th>s_value</th><th>conf_low</th><th>conf_high</th></tr><tr><td>str</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>&quot;b1-b2=b3-b4&quot;</td><td>0.027232</td><td>0.017103</td><td>1.592185</td><td>0.111343</td><td>3.166916</td><td>-0.00629</td><td>0.060754</td></tr></tbody></table></div></div></div>
</div>
<p>Almost; but not quite. But as we’ve seen, significance is not everything - we must also examine whether the model is doing a good job at predicting the data in terms of its classifications. First, we can compute the phi coefficient:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Phi coeff</span>
<span class="c1"># Predictions for all data</span>
<span class="n">all_predictions</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">predictions</span><span class="p">(</span><span class="n">probit_model2</span><span class="p">)</span> 

<span class="c1"># Digitize with .5 as the threshold</span>
<span class="n">binary_predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">digitize</span><span class="p">(</span><span class="n">all_predictions</span><span class="p">[</span><span class="s1">&#39;estimate&#39;</span><span class="p">],</span>
                                 <span class="p">[</span><span class="mf">0.5</span><span class="p">])</span>

<span class="c1"># Correlate</span>
<span class="n">pg</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">affairs</span><span class="p">[</span><span class="s1">&#39;affairyes&#39;</span><span class="p">],</span> <span class="n">binary_predictions</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>n</th>
      <th>r</th>
      <th>CI95%</th>
      <th>p-val</th>
      <th>BF10</th>
      <th>power</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>pearson</th>
      <td>601</td>
      <td>0.101673</td>
      <td>[0.02, 0.18]</td>
      <td>0.012638</td>
      <td>1.136</td>
      <td>0.704305</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>And the final check is to look at the confusion matrix:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Confusion matrix</span>
<span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">affairs</span><span class="p">[</span><span class="s1">&#39;affairyes&#39;</span><span class="p">],</span>
            <span class="n">binary_predictions</span><span class="p">,</span>
            <span class="n">rownames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Observed&#39;</span><span class="p">],</span>
            <span class="n">colnames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Predicted&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Predicted</th>
      <th>0</th>
      <th>1</th>
    </tr>
    <tr>
      <th>Observed</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>442</td>
      <td>9</td>
    </tr>
    <tr>
      <th>1</th>
      <td>141</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>With these two extra pieces of information, its clear the model is not particularly good. Caution and circumspection is always warranted.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./5_Binary"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../4_Prediction/QPoP%20-%20Week%204%20Exercises%20-%20Answers.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Asking scientific questions of models - Exercises &amp; Answers</p>
      </div>
    </a>
    <a class="right-next"
       href="QPoP%20-%20Week%205%20Exercises%20-%20Answers.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Using and understanding probit models - Exercises &amp; Answers</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dealing-with-non-continuous-outcomes">Dealing with non-continuous outcomes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#probit-regression">Probit regression</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dichotomising-data">Dichotomising data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-a-model-and-making-predictions">Fitting a model and making predictions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#checking-fit-and-other-statistics">Checking fit and other statistics</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-log-likelihood-statistic">The log-likelihood statistic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-phi-coefficient">The phi coefficient</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-confusion-matrix">The confusion matrix</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#building-complexity-in-a-probit-model">Building complexity in a probit model</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Alex Jones, Ph.D
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>