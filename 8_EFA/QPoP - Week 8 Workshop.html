
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>8 - Exploratory Factor Analysis &#8212; Statistical Modelling with Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = '8_EFA/QPoP - Week 8 Workshop';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Finding latent variables in data - Exercises &amp; Answers" href="QPoP%20-%20Week%208%20Exercises%20-%20Answers.html" />
    <link rel="prev" title="Dealing with repeated measurements - Exercises &amp; Answers" href="../7_MixedModel/QPoP%20-%20Week%207%20Exercises%20-%20Answers.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Statistical Modelling with Python - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Statistical Modelling with Python - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Statistical Modelling with Python
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Python Basics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../1_Introduction/QPoP%20-%20Week%201%20Workshop.html">1 - Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_Introduction/QPoP%20-%20Week%201%20Exercises%20-%20Answers.html">Using Python for Data Analysis - Exercises &amp; Answers</a></li>






</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">The GLM</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../2_The_GLM/QPoP%20-%20Week%202%20Workshop.html">2 - The General Linear Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_The_GLM/QPoP%20-%20Week%202%20Exercises%20-%20Answers.html">Getting to grips with linear models in Python - Exercises &amp; Answers</a></li>



</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Advancing the GLM</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../3_Advancing_GLM/QPoP%20-%20Week%203%20Workshop.html">3 - Advancing the general linear model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_Advancing_GLM/QPoP%20-%20Week%203%20Exercises%20-%20Answers.html">Checking assumptions and including interactions - Exercises &amp; Answers</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">The art of prediction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../4_Prediction/QPoP%20-%20Week%204%20Workshop.html">4 - The art of prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_Prediction/QPoP%20-%20Week%204%20Exercises%20-%20Answers.html">Asking scientific questions of models - Exercises &amp; Answers</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Binary outcome models</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../5_Binary/QPoP%20-%20Week%205%20Workshop.html">5 - Binary outcome models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../5_Binary/QPoP%20-%20Week%205%20Exercises%20-%20Answers.html">Using and understanding probit models - Exercises &amp; Answers</a></li>



</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Applications and other kinds of hypotheses</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../6_Applications/QPoP%20-%20Week%206%20Workshop.html">6 - Precision in Predictions</a></li>




<li class="toctree-l1"><a class="reference internal" href="../6_Applications/QPoP%20-%20Week%206%20Exercises%20-%20Answers.html">Example exercises using skills so far</a></li>



</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Linear Mixed Effects Models</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../7_MixedModel/QPoP%20-%20Week%207%20Workshop.html">7 - Linear mixed effects models</a></li>

<li class="toctree-l1"><a class="reference internal" href="../7_MixedModel/QPoP%20-%20Week%207%20Exercises%20-%20Answers.html">Dealing with repeated measurements - Exercises &amp; Answers</a></li>




</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Exploratory Factor Analysis</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">8 - Exploratory Factor Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="QPoP%20-%20Week%208%20Exercises%20-%20Answers.html">Finding latent variables in data - Exercises &amp; Answers</a></li>


</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2F8_EFA/QPoP - Week 8 Workshop.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/8_EFA/QPoP - Week 8 Workshop.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>8 - Exploratory Factor Analysis</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#finding-latent-variables-in-data">Finding latent variables in data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#factor-loadings">Factor Loadings</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#factor-variances">Factor variances</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#communalities">Communalities</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-latent-factors-themselves">The latent factors themselves</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#psychometrics-and-efa">Psychometrics and EFA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#but-how-many-factors-are-there">But <strong>how</strong> many factors are there?!</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="exploratory-factor-analysis">
<h1>8 - Exploratory Factor Analysis<a class="headerlink" href="#exploratory-factor-analysis" title="Link to this heading">#</a></h1>
<section id="finding-latent-variables-in-data">
<h2>Finding latent variables in data<a class="headerlink" href="#finding-latent-variables-in-data" title="Link to this heading">#</a></h2>
<p>We now start to move from the traditional modelling framework of using some variables to predict another, and into the realm of exploratory factor analysis (EFA). EFA is a <em>multivariate</em> technique which means that it has no clear distinction on what a ‘predictor’ or an ‘outcome’ variable is - rather, the aim of EFA is to take a set of variables and find another set of variables that represent the original ones. These are the so-called <strong>latent</strong> variables that, under the EFA model, are assumed to “give rise” to the original set of variables.</p>
<p>EFA is commonly used to distil psychological constructs from things like questionnaire data. A popular example in psychology of this is the Big Five personality traits, which emerge from EFA of people rating adjectives about personalities to the extent they feel that are like that - e.g. “outgoing”, “anxious”.</p>
<p>The key thing to remember is that EFA is also a linear model. You can think about it from the following somewhat quirky perspective - what an EFA does is takes each of your original variables, and tries to come up with a set of predictor variables that predicts each original variable well. It has to do that simultaneously for each of the original variables - so its really just coming up with a set of variables that ‘best explain’ all the observed variables at once!</p>
<p>Lets see how we can fit one in Python. To do so, we’ll use a new package, the <code class="docutils literal notranslate"><span class="pre">factor_analyzer</span></code> package, which has a model called <code class="docutils literal notranslate"><span class="pre">FactorAnalyzer</span></code>. Below we import a few key things as well as the new module.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import what we need</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> <span class="c1"># dataframes</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span> <span class="c1"># plots</span>
<span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span> <span class="c1"># Models</span>
<span class="kn">import</span> <span class="nn">marginaleffects</span> <span class="k">as</span> <span class="nn">me</span> <span class="c1"># marginal effects</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> <span class="c1"># numpy for some functions</span>
<span class="kn">import</span> <span class="nn">pingouin</span> <span class="k">as</span> <span class="nn">pg</span>
<span class="kn">from</span> <span class="nn">factor_analyzer</span> <span class="kn">import</span> <span class="n">FactorAnalyzer</span> <span class="c1"># Note we write from factor_analyzer</span>
</pre></div>
</div>
</div>
</div>
<p>To examine this idea, we’ll rely on a classic idea - that of the <em>g</em> factor of intelligence. The dataset below is taken from JASP’s examples and comes from Spearman (1908) himself. It represents a set of scores on the following variables for a group of students:</p>
<ul class="simple">
<li><p>Pitch - Score in pitch discrimination test.</p></li>
<li><p>Light - Score in light discrimination test.</p></li>
<li><p>Weight - Score in weight discrimination test.</p></li>
<li><p>Classics - School grade for classic studies.</p></li>
<li><p>French - School grade for French.</p></li>
<li><p>English - School grade for English.</p></li>
<li><p>Mathematics - School grade for mathematics.</p></li>
</ul>
<p>We can read in the data from the following link, then look at the top 5 rows. <a class="reference external" href="https://raw.githubusercontent.com/alexjonesphd/py4psy2024/refs/heads/main/G%20Factor.csv">https://raw.githubusercontent.com/alexjonesphd/py4psy2024/refs/heads/main/G Factor.csv</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read in data</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/alexjonesphd/py4psy2024/refs/heads/main/G</span><span class="si">%20F</span><span class="s1">actor.csv&#39;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pitch</th>
      <th>Light</th>
      <th>Weight</th>
      <th>Classics</th>
      <th>French</th>
      <th>English</th>
      <th>Mathematics</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>50</td>
      <td>10</td>
      <td>4</td>
      <td>16</td>
      <td>19</td>
      <td>10</td>
      <td>7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>10</td>
      <td>6</td>
      <td>5</td>
      <td>6</td>
      <td>6</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10</td>
      <td>10</td>
      <td>6</td>
      <td>5</td>
      <td>6</td>
      <td>6</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>60</td>
      <td>10</td>
      <td>9</td>
      <td>22</td>
      <td>23</td>
      <td>22</td>
      <td>22</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>12</td>
      <td>5</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Our goal is to find the underlying <em>g</em> variable - that is, ‘intelligence’ - a latent variable that gives rise to all of the scores we see across the tests. We do this by making a <code class="docutils literal notranslate"><span class="pre">FactorAnalyzer</span></code> model and fitting it to the data. Notice a key thing here - we deliberately set the number of factors to 1. This is a crucial consideration. In EFA you <em>must</em> specify the number of factors you want to see <em>before you start!</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Build and fit an EFA with a single factor</span>
<span class="n">efa</span> <span class="o">=</span> <span class="n">FactorAnalyzer</span><span class="p">(</span><span class="n">n_factors</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/miniconda3/envs/py11/lib/python3.11/site-packages/factor_analyzer/factor_analyzer.py:663: UserWarning: No rotation will be performed when the number of factors equals 1.
</pre></div>
</div>
</div>
</div>
<p>With this single model, there are many things to inspect to understand the overall result. Let’s take a look at them!</p>
</section>
<section id="factor-loadings">
<h2>Factor Loadings<a class="headerlink" href="#factor-loadings" title="Link to this heading">#</a></h2>
<p>The first key bit of information is how the original variables correlate with the discovered factor(s). In our example with <em>g</em>, we will see how each individual test correlates with the general measure of intelligence. These are often referred to as ‘factor loadings’, but don’t let the term confuse you - they are correlations of the original variables with the discovered latent variables. We can obtain them from the <code class="docutils literal notranslate"><span class="pre">.loadings</span></code> attribute; here put into a dataframe to look nicer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Obtain loadings</span>
<span class="n">g_loadings</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">efa</span><span class="o">.</span><span class="n">loadings_</span><span class="p">,</span>
                          <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;g_factor&#39;</span><span class="p">],</span>
                          <span class="n">index</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="n">g_loadings</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>g_factor</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Pitch</th>
      <td>0.220054</td>
    </tr>
    <tr>
      <th>Light</th>
      <td>0.162702</td>
    </tr>
    <tr>
      <th>Weight</th>
      <td>0.094585</td>
    </tr>
    <tr>
      <th>Classics</th>
      <td>0.975240</td>
    </tr>
    <tr>
      <th>French</th>
      <td>0.939743</td>
    </tr>
    <tr>
      <th>English</th>
      <td>0.833758</td>
    </tr>
    <tr>
      <th>Mathematics</th>
      <td>0.911261</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>This illustrates scores on mathematics, classics, and French tests are all <em>very</em> strongly correlated with the discovered factor. Conversely, the weight and light tests are poorly correlated. That is, the general intelligence variable does not influence them much.</p>
<p><strong>Convention suggests that if a variable has a correlation with a factor of greater than .4 or less than -.4, it is “loaded” on that factor</strong>.</p>
</section>
<section id="factor-variances">
<h2>Factor variances<a class="headerlink" href="#factor-variances" title="Link to this heading">#</a></h2>
<p>Another important bit of information EFA gives us is the <em>explained variance</em> of the factors. The latent variables will, depending on the data and number of them, do a more or less good job of explaining th variance in the <em>original variables</em>.</p>
<p>We can obtain these from our models <code class="docutils literal notranslate"><span class="pre">.get_factor_variance()</span></code> method, which returns a list of three types - variance of factors (less useful), variance due to each factor (very handy) and cumulative variance. In our case here there is only one value, but later examples will see more factors and thus more variance.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get factor variances</span>
<span class="n">efa</span><span class="o">.</span><span class="n">get_factor_variance</span><span class="p">()</span> 
<span class="c1"># 1. Variance of each factor</span>
<span class="c1"># 2. Amount of variance each factor is responsible for in the data</span>
<span class="c1"># 3. The cumulative variance across the factors</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([3.44360164]), array([0.49194309]), array([0.49194309]))
</pre></div>
</div>
</div>
</div>
</section>
<section id="communalities">
<h2>Communalities<a class="headerlink" href="#communalities" title="Link to this heading">#</a></h2>
<p>This is another example of statisticians using weird words to describe a concept we already know about. Each original variable has a ‘communality’ value - this is simply the amount of variance the factors explain in that variable - remember, an EFA is ‘figuring out’ the <em>predictors</em> of a regression for each of the variables. A good EFA model has high communalities for all variables, typically above .7. In using EFA to build psychometric tests we might drop questions with low communalities. We get communalities like so:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get communalities</span>
<span class="n">comms</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">efa</span><span class="o">.</span><span class="n">get_communalities</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;communality&#39;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">comms</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>communality</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Pitch</th>
      <td>0.048424</td>
    </tr>
    <tr>
      <th>Light</th>
      <td>0.026472</td>
    </tr>
    <tr>
      <th>Weight</th>
      <td>0.008946</td>
    </tr>
    <tr>
      <th>Classics</th>
      <td>0.951093</td>
    </tr>
    <tr>
      <th>French</th>
      <td>0.883117</td>
    </tr>
    <tr>
      <th>English</th>
      <td>0.695152</td>
    </tr>
    <tr>
      <th>Mathematics</th>
      <td>0.830397</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>These look OK for classics, french and mathematics, but poorer for the others - in this simple case the interpretation is similar to the loadings we saw earlier.</p>
</section>
<section id="the-latent-factors-themselves">
<h2>The latent factors themselves<a class="headerlink" href="#the-latent-factors-themselves" title="Link to this heading">#</a></h2>
<p>Finally, if we want to, we can obtain an actual estimate of the latent variable itself from the model. This is useful to examine or to even perhaps include in another model. We do this by asking our EFA model to <code class="docutils literal notranslate"><span class="pre">transform</span></code> the original data, whereupon we get a representation of the latent variable(s). In this case, we obtan scores on <em>g</em>, which look like a Z-scored variable, with higher numbers indicating more intelligence.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Obtain latent scores</span>
<span class="n">latent</span> <span class="o">=</span> <span class="n">efa</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

<span class="c1"># Put it in a dataframe</span>
<span class="n">latent</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">latent</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;g_factor&#39;</span><span class="p">])</span>
<span class="n">latent</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>g_factor</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.255022</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1.004152</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-1.011543</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.510647</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.594142</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-1.303185</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.282946</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1.690320</td>
    </tr>
    <tr>
      <th>8</th>
      <td>-0.255428</td>
    </tr>
    <tr>
      <th>9</th>
      <td>-1.250707</td>
    </tr>
    <tr>
      <th>10</th>
      <td>-0.752566</td>
    </tr>
    <tr>
      <th>11</th>
      <td>1.069516</td>
    </tr>
    <tr>
      <th>12</th>
      <td>-0.096286</td>
    </tr>
    <tr>
      <th>13</th>
      <td>-1.396858</td>
    </tr>
    <tr>
      <th>14</th>
      <td>-0.135562</td>
    </tr>
    <tr>
      <th>15</th>
      <td>0.692286</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1.349655</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1.112337</td>
    </tr>
    <tr>
      <th>18</th>
      <td>0.828171</td>
    </tr>
    <tr>
      <th>19</th>
      <td>0.383408</td>
    </tr>
    <tr>
      <th>20</th>
      <td>-0.237878</td>
    </tr>
    <tr>
      <th>21</th>
      <td>0.668323</td>
    </tr>
    <tr>
      <th>22</th>
      <td>-0.804324</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="psychometrics-and-efa">
<h2>Psychometrics and EFA<a class="headerlink" href="#psychometrics-and-efa" title="Link to this heading">#</a></h2>
<p>A common use case for EFA is in the developmental of psychometric tests or questionnaires. Researchers can use EFA uncover a latent set of dimensions underpinning responses to a questionnaire. In this way they can refine the test by dropping some items, including more, or establishing how many ‘things’ their test is measuring (i.e. is it measuring 5 aspects of personality, or a single construct like intelligence?).</p>
<p>Lets see an example of a larger dataset with more than one latent factor - specifically, the Big Five personality variables. This dataset contains responses from 2,800 people on the Big Five Inventory, a questionnaire measuring personality. There are 25 questions, each asking the person to say how much they agree with a particular statement. The EFA model thus assumes there are several latent variables that give rise to peoples responses on these questions, and our aim is to find them.</p>
<p>The specific questions are available <a class="reference external" href="https://vincentarelbundock.github.io/Rdatasets/doc/psych/bfi.html">here</a>, along with the data at this link: <a class="reference external" href="https://vincentarelbundock.github.io/Rdatasets/csv/psych/bfi.csv">https://vincentarelbundock.github.io/Rdatasets/csv/psych/bfi.csv</a></p>
<p>First, we can read it in and display it. If you take a closer look at the columns, you can see there are five questions for each trait, with each question denoted by an initial and a number, e.g. E1 is the first question measuring Extraversion, O2 the second for Openness, and so on.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Big five data</span>
<span class="n">bf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://vincentarelbundock.github.io/Rdatasets/csv/psych/bfi.csv&#39;</span><span class="p">)</span>
<span class="n">bf</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rownames</th>
      <th>A1</th>
      <th>A2</th>
      <th>A3</th>
      <th>A4</th>
      <th>A5</th>
      <th>C1</th>
      <th>C2</th>
      <th>C3</th>
      <th>C4</th>
      <th>...</th>
      <th>N4</th>
      <th>N5</th>
      <th>O1</th>
      <th>O2</th>
      <th>O3</th>
      <th>O4</th>
      <th>O5</th>
      <th>gender</th>
      <th>education</th>
      <th>age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>61617</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>...</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>6</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>1</td>
      <td>NaN</td>
      <td>16</td>
    </tr>
    <tr>
      <th>1</th>
      <td>61618</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>...</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>2</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>2</td>
      <td>NaN</td>
      <td>18</td>
    </tr>
    <tr>
      <th>2</th>
      <td>61620</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>...</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>2</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>2.0</td>
      <td>2</td>
      <td>NaN</td>
      <td>17</td>
    </tr>
    <tr>
      <th>3</th>
      <td>61621</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>...</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>2</td>
      <td>NaN</td>
      <td>17</td>
    </tr>
    <tr>
      <th>4</th>
      <td>61622</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>...</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>1</td>
      <td>NaN</td>
      <td>17</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 29 columns</p>
</div></div></div>
</div>
<p>We drop the <code class="docutils literal notranslate"><span class="pre">rownames</span></code>, <code class="docutils literal notranslate"><span class="pre">gender</span></code>, <code class="docutils literal notranslate"><span class="pre">education</span></code>, and <code class="docutils literal notranslate"><span class="pre">age</span></code> columns for now.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Drop the non-required columns</span>
<span class="n">bf2</span> <span class="o">=</span> <span class="n">bf</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;rownames&#39;</span><span class="p">,</span> <span class="s1">&#39;gender&#39;</span><span class="p">,</span> <span class="s1">&#39;education&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">])</span>
<span class="n">bf2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A1</th>
      <th>A2</th>
      <th>A3</th>
      <th>A4</th>
      <th>A5</th>
      <th>C1</th>
      <th>C2</th>
      <th>C3</th>
      <th>C4</th>
      <th>C5</th>
      <th>...</th>
      <th>N1</th>
      <th>N2</th>
      <th>N3</th>
      <th>N4</th>
      <th>N5</th>
      <th>O1</th>
      <th>O2</th>
      <th>O3</th>
      <th>O4</th>
      <th>O5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>...</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>6</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>...</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>2</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>...</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>2</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>...</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>...</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 25 columns</p>
</div></div></div>
</div>
<p>We should first decide what to do with the missing data present here, as there are some:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show missing data percentages</span>
<span class="n">bf2</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A1    0.005714
A2    0.009643
A3    0.009286
A4    0.006786
A5    0.005714
C1    0.007500
C2    0.008571
C3    0.007143
C4    0.009286
C5    0.005714
E1    0.008214
E2    0.005714
E3    0.008929
E4    0.003214
E5    0.007500
N1    0.007857
N2    0.007500
N3    0.003929
N4    0.012857
N5    0.010357
O1    0.007857
O2    0.000000
O3    0.010000
O4    0.005000
O5    0.007143
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>An easy solution here is to drop any missing data and analyse only the complete cases.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Complete cases</span>
<span class="n">bf3</span> <span class="o">=</span> <span class="n">bf2</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We’re now ready to begin an EFA model. Our goal is to find latent the latent variables that have given rise to the responses across the questionnaire.</p>
<p>The first question is, of course, how many factors to find! In this case, we have a bit of theory to guide us - there <em>should</em> be five factors, so we will look for 5. We build our EFA model like so, and the first thing we’ll look at is the loadings matrix:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Build EFA </span>
<span class="n">big5_efa</span> <span class="o">=</span> <span class="n">FactorAnalyzer</span><span class="p">(</span><span class="n">n_factors</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">bf3</span><span class="p">)</span>

<span class="c1"># Extract loadings</span>
<span class="n">big5_loadings</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">big5_efa</span><span class="o">.</span><span class="n">loadings_</span><span class="p">,</span> 
                             <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;fac1&#39;</span><span class="p">,</span> <span class="s1">&#39;fac2&#39;</span><span class="p">,</span> <span class="s1">&#39;fac3&#39;</span><span class="p">,</span> <span class="s1">&#39;fac4&#39;</span><span class="p">,</span> <span class="s1">&#39;fac5&#39;</span><span class="p">],</span>
                             <span class="n">index</span><span class="o">=</span><span class="n">bf3</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="c1"># Examine</span>
<span class="n">big5_loadings</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fac1</th>
      <th>fac2</th>
      <th>fac3</th>
      <th>fac4</th>
      <th>fac5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A1</th>
      <td>0.149</td>
      <td>0.123</td>
      <td>0.064</td>
      <td>-0.462</td>
      <td>-0.058</td>
    </tr>
    <tr>
      <th>A2</th>
      <td>0.046</td>
      <td>0.118</td>
      <td>0.065</td>
      <td>0.611</td>
      <td>-0.005</td>
    </tr>
    <tr>
      <th>A3</th>
      <td>0.037</td>
      <td>0.236</td>
      <td>0.010</td>
      <td>0.621</td>
      <td>-0.015</td>
    </tr>
    <tr>
      <th>A4</th>
      <td>-0.027</td>
      <td>0.120</td>
      <td>0.188</td>
      <td>0.411</td>
      <td>-0.174</td>
    </tr>
    <tr>
      <th>A5</th>
      <td>-0.085</td>
      <td>0.331</td>
      <td>-0.031</td>
      <td>0.489</td>
      <td>0.007</td>
    </tr>
    <tr>
      <th>C1</th>
      <td>0.073</td>
      <td>-0.030</td>
      <td>0.567</td>
      <td>-0.028</td>
      <td>0.159</td>
    </tr>
    <tr>
      <th>C2</th>
      <td>0.162</td>
      <td>-0.090</td>
      <td>0.697</td>
      <td>0.040</td>
      <td>0.048</td>
    </tr>
    <tr>
      <th>C3</th>
      <td>0.030</td>
      <td>-0.092</td>
      <td>0.597</td>
      <td>0.066</td>
      <td>-0.063</td>
    </tr>
    <tr>
      <th>C4</th>
      <td>0.173</td>
      <td>0.070</td>
      <td>-0.652</td>
      <td>0.029</td>
      <td>-0.057</td>
    </tr>
    <tr>
      <th>C5</th>
      <td>0.209</td>
      <td>-0.069</td>
      <td>-0.561</td>
      <td>0.026</td>
      <td>0.089</td>
    </tr>
    <tr>
      <th>E1</th>
      <td>-0.034</td>
      <td>-0.636</td>
      <td>0.159</td>
      <td>-0.007</td>
      <td>-0.027</td>
    </tr>
    <tr>
      <th>E2</th>
      <td>0.143</td>
      <td>-0.711</td>
      <td>0.045</td>
      <td>0.013</td>
      <td>-0.000</td>
    </tr>
    <tr>
      <th>E3</th>
      <td>0.093</td>
      <td>0.545</td>
      <td>-0.049</td>
      <td>0.156</td>
      <td>0.233</td>
    </tr>
    <tr>
      <th>E4</th>
      <td>-0.019</td>
      <td>0.660</td>
      <td>-0.033</td>
      <td>0.202</td>
      <td>-0.135</td>
    </tr>
    <tr>
      <th>E5</th>
      <td>0.138</td>
      <td>0.498</td>
      <td>0.229</td>
      <td>-0.034</td>
      <td>0.157</td>
    </tr>
    <tr>
      <th>N1</th>
      <td>0.836</td>
      <td>0.206</td>
      <td>0.023</td>
      <td>-0.248</td>
      <td>-0.103</td>
    </tr>
    <tr>
      <th>N2</th>
      <td>0.791</td>
      <td>0.135</td>
      <td>0.039</td>
      <td>-0.218</td>
      <td>-0.026</td>
    </tr>
    <tr>
      <th>N3</th>
      <td>0.741</td>
      <td>0.012</td>
      <td>0.001</td>
      <td>-0.022</td>
      <td>-0.022</td>
    </tr>
    <tr>
      <th>N4</th>
      <td>0.533</td>
      <td>-0.311</td>
      <td>-0.090</td>
      <td>0.074</td>
      <td>0.087</td>
    </tr>
    <tr>
      <th>N5</th>
      <td>0.529</td>
      <td>-0.139</td>
      <td>0.039</td>
      <td>0.139</td>
      <td>-0.170</td>
    </tr>
    <tr>
      <th>O1</th>
      <td>0.018</td>
      <td>0.193</td>
      <td>0.039</td>
      <td>-0.005</td>
      <td>0.491</td>
    </tr>
    <tr>
      <th>O2</th>
      <td>0.188</td>
      <td>0.043</td>
      <td>-0.061</td>
      <td>0.112</td>
      <td>-0.484</td>
    </tr>
    <tr>
      <th>O3</th>
      <td>0.052</td>
      <td>0.299</td>
      <td>-0.031</td>
      <td>0.045</td>
      <td>0.577</td>
    </tr>
    <tr>
      <th>O4</th>
      <td>0.171</td>
      <td>-0.232</td>
      <td>-0.013</td>
      <td>0.184</td>
      <td>0.370</td>
    </tr>
    <tr>
      <th>O5</th>
      <td>0.105</td>
      <td>0.034</td>
      <td>-0.014</td>
      <td>0.017</td>
      <td>-0.543</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>That’s a LOT of information to take in! How do we know what’s going on? We can use <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> to visualise a loading-heatmap for us with a single line of code. This allows us to visually “see” the loading hotspots.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualise heatmap</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">big5_loadings</span><span class="p">,</span> 
            <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="c1"># Greyscale colour, so black-to-white</span>
            <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># Labels with the actual correlation</span>
            <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.2f&#39;</span><span class="p">)</span> <span class="c1"># Tells the label to be 2 decimal places</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="../_images/b7e8e20e60bd53c6c67168fe5803261d893ad20eed7dcd9d0ec7fb20e69ecd03.png" src="../_images/b7e8e20e60bd53c6c67168fe5803261d893ad20eed7dcd9d0ec7fb20e69ecd03.png" />
</div>
</div>
<p>This is an interesting result. We can see now, clearly, the existence of the factors. For example, <code class="docutils literal notranslate"><span class="pre">fac1</span></code> has high loadings with the five “N” questions, indicating it to be Neuroticism. Similarly, <code class="docutils literal notranslate"><span class="pre">fac2</span></code> has high loadings on the “E” questions, suggesting Extraversion, and so on. Notice some of the other correlations within the factors are relatively high with other types of questions too - its never a clear cut solution.</p>
<p>We can examine our factor variances:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show factor variances</span>
<span class="n">big5_efa</span><span class="o">.</span><span class="n">get_factor_variance</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([2.70387986, 2.48623235, 2.04986716, 1.63844108, 1.46150922]),
 array([0.10815519, 0.09944929, 0.08199469, 0.06553764, 0.05846037]),
 array([0.10815519, 0.20760449, 0.28959917, 0.35513682, 0.41359719]))
</pre></div>
</div>
</div>
</div>
<p>So taken together, all factors capture about half the variance in the data. The first factor (which we think is Neuroticism…!) explains about 10%, the second, Extraversion, explains about 9%, and so on.</p>
<p>What about the communalities? Do any of these indicate anything noteworthy? Again here it is helpful to visualise these.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualise communalities</span>
<span class="n">comms</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">big5_efa</span><span class="o">.</span><span class="n">get_communalities</span><span class="p">(),</span> <span class="n">index</span><span class="o">=</span><span class="n">bf3</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Communality&#39;</span><span class="p">])</span>

<span class="c1"># Show</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">comms</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="../_images/df84b0af70167396d97e4a9159f7046c421775d493532a21d65bb12bc328e1ec.png" src="../_images/df84b0af70167396d97e4a9159f7046c421775d493532a21d65bb12bc328e1ec.png" />
</div>
</div>
<p>Thse don’t look <em>too</em> bad. There are no hard and fast rules about what’s good here, other than higher is better. Some of these like A4 and O4 may raise some eyebrows, but in general these would be acceptable. EFA is more an art than a science!</p>
<p>Its now possible to go one step further and examine the correlations amongst the factors themselves! That is, are the personality traits themselves correlated? This is only possible because we let <code class="docutils literal notranslate"><span class="pre">FactorAnalyzer</span></code> allow them to be correlated - there are many factor analysis approaches that produce completely uncorrelated factors, but as a rule, correlated factors make sense. These are stored in the <code class="docutils literal notranslate"><span class="pre">.phi_</span></code> attribute of the model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get correlations of all factors</span>
<span class="n">factor_corrs</span> <span class="o">=</span> <span class="n">big5_efa</span><span class="o">.</span><span class="n">phi_</span>

<span class="c1"># Tidy it up into a DataFrame, with the suspected names of the factors</span>
<span class="n">factor_corrs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">factor_corrs</span><span class="p">,</span> 
                            <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;neuro&#39;</span><span class="p">,</span> <span class="s1">&#39;extra&#39;</span><span class="p">,</span> <span class="s1">&#39;consci&#39;</span><span class="p">,</span> <span class="s1">&#39;agree&#39;</span><span class="p">,</span> <span class="s1">&#39;open&#39;</span><span class="p">],</span>
                            <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;neuro&#39;</span><span class="p">,</span> <span class="s1">&#39;extra&#39;</span><span class="p">,</span> <span class="s1">&#39;consci&#39;</span><span class="p">,</span> <span class="s1">&#39;agree&#39;</span><span class="p">,</span> <span class="s1">&#39;open&#39;</span><span class="p">])</span>

<span class="n">factor_corrs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>neuro</th>
      <th>extra</th>
      <th>consci</th>
      <th>agree</th>
      <th>open</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>neuro</th>
      <td>1.000000</td>
      <td>-0.256314</td>
      <td>0.398860</td>
      <td>0.142306</td>
      <td>0.345106</td>
    </tr>
    <tr>
      <th>extra</th>
      <td>-0.256314</td>
      <td>1.000000</td>
      <td>-0.224364</td>
      <td>0.040343</td>
      <td>-0.013000</td>
    </tr>
    <tr>
      <th>consci</th>
      <td>0.398860</td>
      <td>-0.224364</td>
      <td>1.000000</td>
      <td>0.191999</td>
      <td>0.236255</td>
    </tr>
    <tr>
      <th>agree</th>
      <td>0.142306</td>
      <td>0.040343</td>
      <td>0.191999</td>
      <td>1.000000</td>
      <td>0.155367</td>
    </tr>
    <tr>
      <th>open</th>
      <td>0.345106</td>
      <td>-0.013000</td>
      <td>0.236255</td>
      <td>0.155367</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Neurotic people are less extraverted but more conscientious, for example. Finally, we can give each person a score on the factors too, by extracting the latent variable score for each person. This would be useful to actually score someones Big 5 traits in terms of the latent variable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract the scores</span>
<span class="n">traits</span> <span class="o">=</span> <span class="n">big5_efa</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">bf3</span><span class="p">)</span>

<span class="c1"># Into a dataframe</span>
<span class="n">traits</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">traits</span><span class="p">,</span>
                      <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;neuro&#39;</span><span class="p">,</span> <span class="s1">&#39;extra&#39;</span><span class="p">,</span> <span class="s1">&#39;consci&#39;</span><span class="p">,</span> <span class="s1">&#39;agree&#39;</span><span class="p">,</span> <span class="s1">&#39;open&#39;</span><span class="p">])</span>

<span class="c1"># show traits</span>
<span class="n">traits</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>neuro</th>
      <th>extra</th>
      <th>consci</th>
      <th>agree</th>
      <th>open</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.368754</td>
      <td>-0.298491</td>
      <td>-1.324973</td>
      <td>-0.917815</td>
      <td>-1.661550</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.081186</td>
      <td>0.352849</td>
      <td>-0.535773</td>
      <td>-0.176275</td>
      <td>-0.278700</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.496539</td>
      <td>0.106411</td>
      <td>-0.047870</td>
      <td>-0.658264</td>
      <td>0.194505</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.136226</td>
      <td>-0.169679</td>
      <td>-1.040085</td>
      <td>-0.115630</td>
      <td>-1.110601</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.369298</td>
      <td>0.230058</td>
      <td>-0.101516</td>
      <td>-0.810210</td>
      <td>-0.725543</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.016293</td>
      <td>1.238686</td>
      <td>1.446943</td>
      <td>0.204831</td>
      <td>0.469544</td>
    </tr>
    <tr>
      <th>6</th>
      <td>-1.188218</td>
      <td>0.204278</td>
      <td>0.182627</td>
      <td>0.137170</td>
      <td>0.776679</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.547863</td>
      <td>-1.806800</td>
      <td>-1.227558</td>
      <td>-2.100190</td>
      <td>-0.616149</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.742044</td>
      <td>0.847145</td>
      <td>1.193344</td>
      <td>0.391977</td>
      <td>0.263996</td>
    </tr>
    <tr>
      <th>9</th>
      <td>-0.188935</td>
      <td>0.247622</td>
      <td>-0.144489</td>
      <td>-0.078716</td>
      <td>-0.329985</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As an example, participant 5 has some particularly high scores on extrversion and conscientiousness, while participant 0 has rather low openness.</p>
</section>
<section id="but-how-many-factors-are-there">
<h2>But <strong>how</strong> many factors are there?!<a class="headerlink" href="#but-how-many-factors-are-there" title="Link to this heading">#</a></h2>
<p>We come now to the crux of EFA, and a point that causes dramatic discussion in the academic literature. For example you may have heard of the HEXACO model of personality (six factors) as opposed to the Big 5 - the same kinds of data can produce different numbers of factors. How do we choose the number of factors to extract? In the above examples we had a good theoretical grounding that guided us, but often times we are using EFA in an <em>exploratory</em> sense, that is, to explore the possible latent variables in the data.</p>
<p>There are many, many techniques for determining the number of factors in a dataset, and all of them come with caveats and controversy. This is - and has been for decades - an active area of research in statistics. We will look at one technique here which does reasonably well at identifying the “right” number of factors, and has a sensible philosophical background, called <em>parallel analysis</em>.</p>
<p>How it works is technical, but the basic idea goes like this:</p>
<ol class="arabic simple">
<li><p>Looking at the data you have collected, create a set of randomly-generated data that is the same number of rows and columns that is basically entirely uncorrelated.</p></li>
<li><p>Conduct a factor analysis on this created data, with the number of factors set to the number of variables (e.g. if 10 variables, get 10 factors), and calculate the ‘eigenvalues’ - these represent how much variance each factor explains.</p></li>
<li><p>Repeat step 2 thousands of times and collect all the variances explained for each factor.</p></li>
<li><p>Now in your real data, conducted the factor analysis with the number of factors equal to the number of variables. Get the variances explained.</p></li>
<li><p>Find where the variances in your actual data are <em>above and beyond</em> those seen from step 3. Count along until the variances of the real data <em>are within the bounds</em> of those at step 3. The number of factors up to that point is a good guess of how many factors there are, simply because beyond that the values are consistent with <em>entirely made up nonsense data!</em></p></li>
</ol>
<p>That sounds complicated, but its really using the idea of what you’d expect to see by chance as a way to understand what you see your data. Fortunately, conducting it in Python is very simple.</p>
<p>We use the <code class="docutils literal notranslate"><span class="pre">parallel_analysis</span></code> function from the <code class="docutils literal notranslate"><span class="pre">horns</span></code> package. We specify the analysis type as ‘fa’ (this approach also works for other types of analyses in this domain, like principal components analysis, so we are explicit to tell it we want an EFA), ask for the full output, and we have to convert our DataFrame to a <code class="docutils literal notranslate"><span class="pre">numpy</span></code> array. We also limit it to 500 repeats, as more take longer!</p>
<p>Its as simple as the below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import</span>
<span class="kn">from</span> <span class="nn">horns</span> <span class="kn">import</span> <span class="n">parallel_analysis</span>

<span class="c1"># Conduct</span>
<span class="n">pa_results</span> <span class="o">=</span> <span class="n">parallel_analysis</span><span class="p">(</span><span class="n">bf3</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="n">simulations</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">analysis_type</span><span class="o">=</span><span class="s1">&#39;fa&#39;</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>OMP: Info #276: omp_set_nested routine deprecated, please use omp_set_max_active_levels instead.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>OMP: Info #276: omp_set_nested routine deprecated, please use omp_set_max_active_levels instead.
OMP: Info #276: omp_set_nested routine deprecated, please use omp_set_max_active_levels instead.
OMP: Info #276: omp_set_nested routine deprecated, please use omp_set_max_active_levels instead.
OMP: Info #276: omp_set_nested routine deprecated, please use omp_set_max_active_levels instead.
OMP: Info #276: omp_set_nested routine deprecated, please use omp_set_max_active_levels instead.
OMP: Info #276: omp_set_nested routine deprecated, please use omp_set_max_active_levels instead.
OMP: Info #276: omp_set_nested routine deprecated, please use omp_set_max_active_levels instead.
OMP: Info #276: omp_set_nested routine deprecated, please use omp_set_max_active_levels instead.
OMP: Info #276: omp_set_nested routine deprecated, please use omp_set_max_active_levels instead.
OMP: Info #276: omp_set_nested routine deprecated, please use omp_set_max_active_levels instead.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>OMP: Info #276: omp_set_nested routine deprecated, please use omp_set_max_active_levels instead.
</pre></div>
</div>
<img alt="../_images/de8be8f9c89f8270cc9d848858c38db17ce123776878dec7f5c01b3e6a9b6f1b.png" src="../_images/de8be8f9c89f8270cc9d848858c38db17ce123776878dec7f5c01b3e6a9b6f1b.png" />
</div>
</div>
<p>Parallel analysis returns a plot and a dictionary of results. The plot shows the cutoff points at which number of factors are most ‘surprising’ given a dataset of this size and shape. We can access the number of factors as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print number of factors</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pa_results</span><span class="p">[</span><span class="s1">&#39;factors&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8
</pre></div>
</div>
</div>
</div>
<p>So despite us selecting out 5, parallel analysis suggests there <em>eight</em> latent factors in the data!</p>
<p>EFA is as much an art as it is a science (much like other forms of modelling), so take care when conducting it. Blindly following one approach (like top-down theory) or another (bottom-up approaches like parallel analysis) can lead you astray. To finish, let’s see what an 8-factor solution of personality looks like:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 8 factors</span>
<span class="n">big8_efa</span> <span class="o">=</span> <span class="n">FactorAnalyzer</span><span class="p">(</span><span class="n">n_factors</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">bf3</span><span class="p">)</span>

<span class="c1"># Examine the loadings</span>
<span class="n">loadings_8</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">big8_efa</span><span class="o">.</span><span class="n">loadings_</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">bf3</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;fa1&#39;</span><span class="p">,</span> <span class="s1">&#39;fa2&#39;</span><span class="p">,</span> <span class="s1">&#39;fa3&#39;</span><span class="p">,</span> <span class="s1">&#39;fa4&#39;</span><span class="p">,</span> <span class="s1">&#39;fa5&#39;</span><span class="p">,</span> <span class="s1">&#39;fa6&#39;</span><span class="p">,</span> <span class="s1">&#39;fa7&#39;</span><span class="p">,</span> <span class="s1">&#39;fa8&#39;</span><span class="p">])</span>

<span class="c1"># Heatmap</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">loadings_8</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.2f&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="../_images/50729c8bfd4df33af7478baee5331ab8c39dbf708f1b7fd3b13d02228d870339.png" src="../_images/50729c8bfd4df33af7478baee5331ab8c39dbf708f1b7fd3b13d02228d870339.png" />
</div>
</div>
<p>Notice here that while traits like Neuroticism and Openness orrelate with one factor (number 1 and 4 respectively), there are ‘dilutions’ of other traits across factors - Extraversion is spread across factors 2 and 5, and some aspects of it onto factor 8. This would be a cause for concern for psychometricians hoping for a neat set of questions measuring 5 latent factors and might result in a re-thinking of certain questions.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./8_EFA"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../7_MixedModel/QPoP%20-%20Week%207%20Exercises%20-%20Answers.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Dealing with repeated measurements - Exercises &amp; Answers</p>
      </div>
    </a>
    <a class="right-next"
       href="QPoP%20-%20Week%208%20Exercises%20-%20Answers.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Finding latent variables in data - Exercises &amp; Answers</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#finding-latent-variables-in-data">Finding latent variables in data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#factor-loadings">Factor Loadings</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#factor-variances">Factor variances</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#communalities">Communalities</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-latent-factors-themselves">The latent factors themselves</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#psychometrics-and-efa">Psychometrics and EFA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#but-how-many-factors-are-there">But <strong>how</strong> many factors are there?!</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Alex Jones, Ph.D
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>