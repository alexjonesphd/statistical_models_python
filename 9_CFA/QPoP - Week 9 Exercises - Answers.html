
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Fitting latent variables onto data - Exercises &amp; Answers &#8212; Statistical Modelling with Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = '9_CFA/QPoP - Week 9 Exercises - Answers';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="9 - Confirmatory Factor Analysis" href="QPoP%20-%20Week%209%20Workshop.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Statistical Modelling with Python - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Statistical Modelling with Python - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Statistical Modelling with Python
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Python Basics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../1_Introduction/QPoP%20-%20Week%201%20Workshop.html">1 - Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_Introduction/QPoP%20-%20Week%201%20Exercises%20-%20Answers.html">Using Python for Data Analysis - Exercises &amp; Answers</a></li>






</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">The GLM</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../2_The_GLM/QPoP%20-%20Week%202%20Workshop.html">2 - The General Linear Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_The_GLM/QPoP%20-%20Week%202%20Exercises%20-%20Answers.html">Getting to grips with linear models in Python - Exercises &amp; Answers</a></li>



</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Advancing the GLM</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../3_Advancing_GLM/QPoP%20-%20Week%203%20Workshop.html">3 - Advancing the general linear model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_Advancing_GLM/QPoP%20-%20Week%203%20Exercises%20-%20Answers.html">Checking assumptions and including interactions - Exercises &amp; Answers</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">The art of prediction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../4_Prediction/QPoP%20-%20Week%204%20Workshop.html">4 - The art of prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_Prediction/QPoP%20-%20Week%204%20Exercises%20-%20Answers.html">Asking scientific questions of models - Exercises &amp; Answers</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Binary outcome models</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../5_Binary/QPoP%20-%20Week%205%20Workshop.html">5 - Binary outcome models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../5_Binary/QPoP%20-%20Week%205%20Exercises%20-%20Answers.html">Using and understanding probit models - Exercises &amp; Answers</a></li>



</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Applications and other kinds of hypotheses</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../6_Applications/QPoP%20-%20Week%206%20Workshop.html">6 - Precision in Predictions</a></li>




<li class="toctree-l1"><a class="reference internal" href="../6_Applications/QPoP%20-%20Week%206%20Exercises%20-%20Answers.html">Example exercises using skills so far</a></li>



</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Linear Mixed Effects Models</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../7_MixedModel/QPoP%20-%20Week%207%20Workshop.html">7 - Linear mixed effects models</a></li>

<li class="toctree-l1"><a class="reference internal" href="../7_MixedModel/QPoP%20-%20Week%207%20Exercises%20-%20Answers.html">Dealing with repeated measurements - Exercises &amp; Answers</a></li>




</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Exploratory Factor Analysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../8_EFA/QPoP%20-%20Week%208%20Workshop.html">8 - Exploratory Factor Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_EFA/QPoP%20-%20Week%208%20Exercises%20-%20Answers.html">Finding latent variables in data - Exercises &amp; Answers</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Confirmatory Factor Analysis</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="QPoP%20-%20Week%209%20Workshop.html">9 - Confirmatory Factor Analysis</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Fitting latent variables onto data - Exercises &amp; Answers</a></li>







</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2F9_CFA/QPoP - Week 9 Exercises - Answers.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/9_CFA/QPoP - Week 9 Exercises - Answers.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Fitting latent variables onto data - Exercises & Answers</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Fitting latent variables onto data - Exercises &amp; Answers</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#grit-revisited-are-we-sure-its-there">1. Grit revisited - are we <em>sure</em> its there?</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#important">Important</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#building-a-latent-factor-model-of-grit">Building a latent factor model of grit</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#grit-and-conscientiousness">2. Grit and conscientiousness</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#latent-regressions">3. Latent regressions</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#testing-the-presence-of-the-big-five-in-big-data">4. Testing the presence of the Big Five - in Big Data</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#exploring-and-confirming">5. Exploring and confirming</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="fitting-latent-variables-onto-data-exercises-answers">
<h1>Fitting latent variables onto data - Exercises &amp; Answers<a class="headerlink" href="#fitting-latent-variables-onto-data-exercises-answers" title="Link to this heading">#</a></h1>
</section>
<section id="grit-revisited-are-we-sure-its-there">
<h1>1. Grit revisited - are we <em>sure</em> its there?<a class="headerlink" href="#grit-revisited-are-we-sure-its-there" title="Link to this heading">#</a></h1>
<p>Armed with new knowledge of CFA, we can now examine directly whether the two-factor structure claimed in the research literature exists in the data we have to hand. While our use of EFA indirectly explored the latent variables in that dataset, with CFA we explicitly test the presence of two factors and set certain questions to load onto these variables.</p>
<p>First, lets re-obtain the data that has the grit questionnaire in it.</p>
<p>Download the data from this link: <a class="reference external" href="https://openpsychometrics.org/_rawdata/duckworth-grit-scale-data.zip">https://openpsychometrics.org/_rawdata/duckworth-grit-scale-data.zip</a></p>
<p>You will need to unzip it and grab the <code class="docutils literal notranslate"><span class="pre">data.csv</span></code> file.</p>
<p>Import everything we need first, adding <code class="docutils literal notranslate"><span class="pre">semopy</span></code> to the list of packages we will use.</p>
</section>
<section id="important">
<h1>Important<a class="headerlink" href="#important" title="Link to this heading">#</a></h1>
<p>After importing everything, run this command just underneath your imports. It’ll ensure the results will match when running this code elsehwere.
<code class="docutils literal notranslate"><span class="pre">np.random.seed(36)</span></code></p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your answer here</span>
<span class="c1"># Import what we need</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> <span class="c1"># dataframes</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span> <span class="c1"># plots</span>
<span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span> <span class="c1"># Models</span>
<span class="kn">import</span> <span class="nn">marginaleffects</span> <span class="k">as</span> <span class="nn">me</span> <span class="c1"># marginal effects</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> <span class="c1"># numpy for some functions</span>
<span class="kn">import</span> <span class="nn">pingouin</span> <span class="k">as</span> <span class="nn">pg</span>
<span class="kn">from</span> <span class="nn">factor_analyzer</span> <span class="kn">import</span> <span class="n">FactorAnalyzer</span> <span class="c1"># Note we write from factor_analyzer</span>
<span class="kn">from</span> <span class="nn">horns</span> <span class="kn">import</span> <span class="n">parallel_analysis</span>
<span class="kn">import</span> <span class="nn">semopy</span> <span class="k">as</span> <span class="nn">sem</span> <span class="c1"># semopy imported here</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">36</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Read in the data into a dataframe called grit, specifying the separator as ‘\t’ (sep=’\t’), as before.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your answer here</span>
<span class="c1"># Read in</span>
<span class="n">grit</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">grit</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>surveyelapse</th>
      <th>GS1</th>
      <th>GS2</th>
      <th>GS3</th>
      <th>GS4</th>
      <th>GS5</th>
      <th>GS6</th>
      <th>GS7</th>
      <th>GS8</th>
      <th>...</th>
      <th>O7</th>
      <th>O8</th>
      <th>O9</th>
      <th>O10</th>
      <th>operatingsystem</th>
      <th>browser</th>
      <th>screenw</th>
      <th>screenh</th>
      <th>introelapse</th>
      <th>testelapse</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>RO</td>
      <td>174</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>...</td>
      <td>5</td>
      <td>4</td>
      <td>5</td>
      <td>4</td>
      <td>Windows</td>
      <td>Chrome</td>
      <td>1366</td>
      <td>768</td>
      <td>69590</td>
      <td>307</td>
    </tr>
    <tr>
      <th>1</th>
      <td>US</td>
      <td>120</td>
      <td>2</td>
      <td>2</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>...</td>
      <td>4</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>Macintosh</td>
      <td>Chrome</td>
      <td>1280</td>
      <td>800</td>
      <td>33657</td>
      <td>134</td>
    </tr>
    <tr>
      <th>2</th>
      <td>US</td>
      <td>99</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>4</td>
      <td>3</td>
      <td>4</td>
      <td>4</td>
      <td>...</td>
      <td>5</td>
      <td>5</td>
      <td>4</td>
      <td>4</td>
      <td>Windows</td>
      <td>Firefox</td>
      <td>1920</td>
      <td>1080</td>
      <td>95550</td>
      <td>138</td>
    </tr>
    <tr>
      <th>3</th>
      <td>KE</td>
      <td>5098</td>
      <td>1</td>
      <td>3</td>
      <td>4</td>
      <td>2</td>
      <td>4</td>
      <td>1</td>
      <td>5</td>
      <td>4</td>
      <td>...</td>
      <td>4</td>
      <td>2</td>
      <td>5</td>
      <td>4</td>
      <td>Windows</td>
      <td>Chrome</td>
      <td>1600</td>
      <td>900</td>
      <td>4</td>
      <td>4440</td>
    </tr>
    <tr>
      <th>4</th>
      <td>JP</td>
      <td>340</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>4</td>
      <td>...</td>
      <td>4</td>
      <td>1</td>
      <td>3</td>
      <td>2</td>
      <td>Windows</td>
      <td>Firefox</td>
      <td>1920</td>
      <td>1080</td>
      <td>3</td>
      <td>337</td>
    </tr>
    <tr>
      <th>5</th>
      <td>AU</td>
      <td>515</td>
      <td>1</td>
      <td>2</td>
      <td>5</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>4</td>
      <td>5</td>
      <td>...</td>
      <td>5</td>
      <td>2</td>
      <td>5</td>
      <td>5</td>
      <td>Windows</td>
      <td>Chrome</td>
      <td>1920</td>
      <td>1080</td>
      <td>2090</td>
      <td>554</td>
    </tr>
    <tr>
      <th>6</th>
      <td>US</td>
      <td>126</td>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>Windows</td>
      <td>Chrome</td>
      <td>1366</td>
      <td>768</td>
      <td>36</td>
      <td>212</td>
    </tr>
    <tr>
      <th>7</th>
      <td>RO</td>
      <td>208</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
      <td>3</td>
      <td>4</td>
      <td>4</td>
      <td>...</td>
      <td>5</td>
      <td>3</td>
      <td>4</td>
      <td>3</td>
      <td>Windows</td>
      <td>Chrome</td>
      <td>1366</td>
      <td>768</td>
      <td>6</td>
      <td>207</td>
    </tr>
    <tr>
      <th>8</th>
      <td>EU</td>
      <td>130</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
      <td>5</td>
      <td>4</td>
      <td>...</td>
      <td>5</td>
      <td>1</td>
      <td>4</td>
      <td>5</td>
      <td>Windows</td>
      <td>Microsoft Internet Explorer</td>
      <td>1600</td>
      <td>1000</td>
      <td>14</td>
      <td>183</td>
    </tr>
    <tr>
      <th>9</th>
      <td>NZ</td>
      <td>129</td>
      <td>2</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>4</td>
      <td>2</td>
      <td>4</td>
      <td>4</td>
      <td>...</td>
      <td>4</td>
      <td>3</td>
      <td>4</td>
      <td>4</td>
      <td>Macintosh</td>
      <td>Chrome</td>
      <td>1440</td>
      <td>900</td>
      <td>68</td>
      <td>143</td>
    </tr>
  </tbody>
</table>
<p>10 rows × 98 columns</p>
</div></div></div>
</div>
<p>Like before, get the grit-related columns by keeping only the columns with ‘GS’ in them. Store in a dataframe called <code class="docutils literal notranslate"><span class="pre">grit2</span></code>.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your answer here</span>
<span class="n">grit2</span> <span class="o">=</span> <span class="n">grit</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="s1">&#39;GS\d+&#39;</span><span class="p">)</span>
<span class="n">grit2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GS1</th>
      <th>GS2</th>
      <th>GS3</th>
      <th>GS4</th>
      <th>GS5</th>
      <th>GS6</th>
      <th>GS7</th>
      <th>GS8</th>
      <th>GS9</th>
      <th>GS10</th>
      <th>GS11</th>
      <th>GS12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>2</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>2</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>4</td>
      <td>3</td>
      <td>4</td>
      <td>4</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>3</td>
      <td>4</td>
      <td>2</td>
      <td>4</td>
      <td>1</td>
      <td>5</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>4</td>
      <td>3</td>
      <td>3</td>
      <td>4</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="building-a-latent-factor-model-of-grit">
<h1>Building a latent factor model of grit<a class="headerlink" href="#building-a-latent-factor-model-of-grit" title="Link to this heading">#</a></h1>
<p>We take the model directly stated from the original Duckworth et al (2007) paper that described the grit scale. The questions loading onto the two latent grit factors are as follows:</p>
<ul class="simple">
<li><p>Consistency in interest</p>
<ul>
<li><p>GS2</p></li>
<li><p>GS3</p></li>
<li><p>GS5</p></li>
<li><p>GS7</p></li>
<li><p>GS8</p></li>
<li><p>GS11</p></li>
</ul>
</li>
<li><p>Perseverance in effort</p>
<ul>
<li><p>GS1</p></li>
<li><p>GS4</p></li>
<li><p>GS6</p></li>
<li><p>GS9</p></li>
<li><p>GS10</p></li>
<li><p>GS12</p></li>
</ul>
</li>
</ul>
<p>With that in mind, create a CFA model that tests whether the two latent variables (consistency and perseverance) are measured by the above stated questionnaire variables. Create it and fit it in <code class="docutils literal notranslate"><span class="pre">semopy</span></code>.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your answer here</span>
<span class="c1"># Model string</span>
<span class="n">mdspec</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">consistency =~ GS2 + GS3 + GS5 + GS7 + GS8 + GS11</span>
<span class="s2">perseverance =~ GS1 + GS4 + GS6 + GS9 + GS10 + GS12</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="c1"># Create model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">sem</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">mdspec</span><span class="p">)</span>

<span class="c1"># Fit it</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">grit2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SolverResult(fun=0.3782276478265841, success=True, n_it=24, x=array([ 1.122537  ,  1.36719906,  1.39375519,  1.44706539,  0.80596871,
        0.85883226,  1.32252661,  1.43824065,  1.57281968,  1.28650847,
        0.68358768,  1.09217894,  0.98222584,  0.57969277,  0.8487556 ,
        0.96281907,  1.19213773,  0.82104992,  0.57220757,  0.61039529,
        0.78652695,  0.66075116,  0.45345085,  0.29510074, -0.2184887 ]), message=&#39;Optimization terminated successfully&#39;, name_method=&#39;SLSQP&#39;, name_obj=&#39;MLW&#39;)
</pre></div>
</div>
</div>
</div>
<p>If you have fitted the model successfully, inspect the standardised loadings. Do they appear significant and sensible?</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your answer here</span>
<span class="n">model</span><span class="o">.</span><span class="n">inspect</span><span class="p">(</span><span class="n">std_est</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>lval</th>
      <th>op</th>
      <th>rval</th>
      <th>Estimate</th>
      <th>Est. Std</th>
      <th>Std. Err</th>
      <th>z-value</th>
      <th>p-value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>GS2</td>
      <td>~</td>
      <td>consistency</td>
      <td>1.000000</td>
      <td>0.590099</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
    </tr>
    <tr>
      <th>1</th>
      <td>GS3</td>
      <td>~</td>
      <td>consistency</td>
      <td>1.122537</td>
      <td>0.610272</td>
      <td>0.035904</td>
      <td>31.264817</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>GS5</td>
      <td>~</td>
      <td>consistency</td>
      <td>1.367199</td>
      <td>0.712711</td>
      <td>0.039375</td>
      <td>34.72214</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>GS7</td>
      <td>~</td>
      <td>consistency</td>
      <td>1.393755</td>
      <td>0.768558</td>
      <td>0.038401</td>
      <td>36.295186</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>GS8</td>
      <td>~</td>
      <td>consistency</td>
      <td>1.447065</td>
      <td>0.739557</td>
      <td>0.040748</td>
      <td>35.512611</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>GS11</td>
      <td>~</td>
      <td>consistency</td>
      <td>0.805969</td>
      <td>0.480314</td>
      <td>0.030976</td>
      <td>26.019401</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>GS1</td>
      <td>~</td>
      <td>perseverance</td>
      <td>1.000000</td>
      <td>0.549115</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
    </tr>
    <tr>
      <th>7</th>
      <td>GS4</td>
      <td>~</td>
      <td>perseverance</td>
      <td>0.858832</td>
      <td>0.392929</td>
      <td>0.041181</td>
      <td>20.85489</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>GS6</td>
      <td>~</td>
      <td>perseverance</td>
      <td>1.322527</td>
      <td>0.688657</td>
      <td>0.042987</td>
      <td>30.765874</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>GS9</td>
      <td>~</td>
      <td>perseverance</td>
      <td>1.438241</td>
      <td>0.692969</td>
      <td>0.046594</td>
      <td>30.867441</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>GS10</td>
      <td>~</td>
      <td>perseverance</td>
      <td>1.572820</td>
      <td>0.632947</td>
      <td>0.053624</td>
      <td>29.330766</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>GS12</td>
      <td>~</td>
      <td>perseverance</td>
      <td>1.286508</td>
      <td>0.676221</td>
      <td>0.042229</td>
      <td>30.464843</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>consistency</td>
      <td>~~</td>
      <td>consistency</td>
      <td>0.453451</td>
      <td>1.000000</td>
      <td>0.023116</td>
      <td>19.616305</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>perseverance</td>
      <td>~~</td>
      <td>perseverance</td>
      <td>0.295101</td>
      <td>1.000000</td>
      <td>0.016762</td>
      <td>17.605834</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>perseverance</td>
      <td>~~</td>
      <td>consistency</td>
      <td>-0.218489</td>
      <td>-0.597281</td>
      <td>0.010538</td>
      <td>-20.732445</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>GS1</td>
      <td>~~</td>
      <td>GS1</td>
      <td>0.683588</td>
      <td>0.698473</td>
      <td>0.016434</td>
      <td>41.597162</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>GS10</td>
      <td>~~</td>
      <td>GS10</td>
      <td>1.092179</td>
      <td>0.599378</td>
      <td>0.027985</td>
      <td>39.027627</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>GS11</td>
      <td>~~</td>
      <td>GS11</td>
      <td>0.982226</td>
      <td>0.769299</td>
      <td>0.02249</td>
      <td>43.672973</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>GS12</td>
      <td>~~</td>
      <td>GS12</td>
      <td>0.579693</td>
      <td>0.542725</td>
      <td>0.015614</td>
      <td>37.126657</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>GS2</td>
      <td>~~</td>
      <td>GS2</td>
      <td>0.848756</td>
      <td>0.651783</td>
      <td>0.02037</td>
      <td>41.667457</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>GS3</td>
      <td>~~</td>
      <td>GS3</td>
      <td>0.962819</td>
      <td>0.627568</td>
      <td>0.023394</td>
      <td>41.157212</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>21</th>
      <td>GS4</td>
      <td>~~</td>
      <td>GS4</td>
      <td>1.192138</td>
      <td>0.845607</td>
      <td>0.026929</td>
      <td>44.269472</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>GS5</td>
      <td>~~</td>
      <td>GS5</td>
      <td>0.821050</td>
      <td>0.492043</td>
      <td>0.021991</td>
      <td>37.336067</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>GS6</td>
      <td>~~</td>
      <td>GS6</td>
      <td>0.572208</td>
      <td>0.525751</td>
      <td>0.015686</td>
      <td>36.478381</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>24</th>
      <td>GS7</td>
      <td>~~</td>
      <td>GS7</td>
      <td>0.610395</td>
      <td>0.409318</td>
      <td>0.018072</td>
      <td>33.77512</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>25</th>
      <td>GS8</td>
      <td>~~</td>
      <td>GS8</td>
      <td>0.786527</td>
      <td>0.453055</td>
      <td>0.021966</td>
      <td>35.806484</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>GS9</td>
      <td>~~</td>
      <td>GS9</td>
      <td>0.660751</td>
      <td>0.519794</td>
      <td>0.018232</td>
      <td>36.241337</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Finally, check the fit statistics. Is this model any good? Does it describe the data well?</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your answer here</span>
<span class="n">sem</span><span class="o">.</span><span class="n">calc_stats</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DoF</th>
      <th>DoF Baseline</th>
      <th>chi2</th>
      <th>chi2 p-value</th>
      <th>chi2 Baseline</th>
      <th>CFI</th>
      <th>GFI</th>
      <th>AGFI</th>
      <th>NFI</th>
      <th>TLI</th>
      <th>RMSEA</th>
      <th>AIC</th>
      <th>BIC</th>
      <th>LogLik</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Value</th>
      <td>53</td>
      <td>66</td>
      <td>1615.032056</td>
      <td>0.0</td>
      <td>15958.962524</td>
      <td>0.901715</td>
      <td>0.898801</td>
      <td>0.873979</td>
      <td>0.898801</td>
      <td>0.877608</td>
      <td>0.083089</td>
      <td>49.243545</td>
      <td>208.227772</td>
      <td>0.378228</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>What do the guidelines suggest we should do with this model? Do the statistics suggest it fits the model well?</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your answer here</span>
<span class="c1"># Not fully. its close in many regards but only just squeaks across the line.</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="grit-and-conscientiousness">
<h1>2. Grit and conscientiousness<a class="headerlink" href="#grit-and-conscientiousness" title="Link to this heading">#</a></h1>
<p>Let us now expand the use of CFA and dip into the idea of SEM a little. Here we’ll expand our previous exercise where we conducted an EFA on scores from the Big 5 trait Conscientiousness at the same time as the grit scale. In the following we’ll see what happens if we specify our grit model like we just did, but also include the data for Conscientiousness and its associated questions. As such, we’ll find three latent variables (the two grit related ones from the grit questionnaire, and one for Conscientiousness).</p>
<p>First, get the right questions out of the main <code class="docutils literal notranslate"><span class="pre">grit</span></code> dataframe and store it in a dataframe called <code class="docutils literal notranslate"><span class="pre">grit_consc</span></code>. It should include all questions with <code class="docutils literal notranslate"><span class="pre">GS</span></code> in them and <code class="docutils literal notranslate"><span class="pre">C</span></code>.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your answer here</span>
<span class="c1"># Get grit and conscientiousness</span>
<span class="n">grit_consc_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;GS1&#39;</span><span class="p">,</span> <span class="s1">&#39;GS2&#39;</span><span class="p">,</span> <span class="s1">&#39;GS3&#39;</span><span class="p">,</span> <span class="s1">&#39;GS4&#39;</span><span class="p">,</span> <span class="s1">&#39;GS5&#39;</span><span class="p">,</span> <span class="s1">&#39;GS6&#39;</span><span class="p">,</span> <span class="s1">&#39;GS7&#39;</span><span class="p">,</span> <span class="s1">&#39;GS8&#39;</span><span class="p">,</span> <span class="s1">&#39;GS9&#39;</span><span class="p">,</span> <span class="s1">&#39;GS10&#39;</span><span class="p">,</span> <span class="s1">&#39;GS11&#39;</span><span class="p">,</span> <span class="s1">&#39;GS12&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="s1">&#39;C5&#39;</span><span class="p">,</span> <span class="s1">&#39;C6&#39;</span><span class="p">,</span> <span class="s1">&#39;C7&#39;</span><span class="p">,</span> <span class="s1">&#39;C8&#39;</span><span class="p">,</span> <span class="s1">&#39;C9&#39;</span><span class="p">,</span> <span class="s1">&#39;C10&#39;</span><span class="p">]</span>

<span class="c1"># Extract them</span>
<span class="n">grit_consc</span> <span class="o">=</span> <span class="n">grit</span><span class="p">[</span><span class="n">grit_consc_names</span><span class="p">]</span>

<span class="c1"># Show </span>
<span class="n">grit_consc</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GS1</th>
      <th>GS2</th>
      <th>GS3</th>
      <th>GS4</th>
      <th>GS5</th>
      <th>GS6</th>
      <th>GS7</th>
      <th>GS8</th>
      <th>GS9</th>
      <th>GS10</th>
      <th>...</th>
      <th>C1</th>
      <th>C2</th>
      <th>C3</th>
      <th>C4</th>
      <th>C5</th>
      <th>C6</th>
      <th>C7</th>
      <th>C8</th>
      <th>C9</th>
      <th>C10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>2</td>
      <td>...</td>
      <td>2</td>
      <td>4</td>
      <td>4</td>
      <td>3</td>
      <td>2</td>
      <td>4</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>2</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
      <td>...</td>
      <td>4</td>
      <td>3</td>
      <td>4</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>5</td>
      <td>2</td>
      <td>5</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>4</td>
      <td>3</td>
      <td>4</td>
      <td>4</td>
      <td>3</td>
      <td>3</td>
      <td>...</td>
      <td>2</td>
      <td>2</td>
      <td>4</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>3</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>3</td>
      <td>4</td>
      <td>2</td>
      <td>4</td>
      <td>1</td>
      <td>5</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>4</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
      <td>4</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>4</td>
      <td>3</td>
      <td>3</td>
      <td>...</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
      <td>3</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 22 columns</p>
</div></div></div>
</div>
<p>Set up a CFA model in which the two grit latent variables are captured exactly like in the last exercise, and the conscientiousness variable is captured by its own questions.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your answer here</span>
<span class="c1"># Model string</span>
<span class="n">mdspec</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">consistency =~ GS2 + GS3 + GS5 + GS7 + GS8 + GS11</span>
<span class="s2">perseverance =~ GS1 + GS4 + GS6 + GS9 + GS10 + GS12</span>
<span class="s2">conscientious =~ C1 + C2 + C3 + C4 + C5 + C6 + C7 + C8 + C9 + C10</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="c1"># Create model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">sem</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">mdspec</span><span class="p">)</span>

<span class="c1"># Fit it</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">grit_consc</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SolverResult(fun=0.9710709627618641, success=True, n_it=53, x=array([ 1.09313912,  1.33437186,  1.36302138,  1.42916659,  0.78741412,
        0.85064734,  1.3914137 ,  1.49500594,  1.55809767,  1.34514398,
       -0.94997207,  0.48329836, -1.02899316,  1.07190153, -1.08682284,
        0.76813297, -0.81079549,  1.03262499,  0.65658523,  0.75014797,
        0.79137018,  1.38099037,  0.83962298,  1.02983492,  0.96540542,
        1.30342655,  0.96076268,  0.9050828 ,  0.9585767 ,  0.70049588,
        1.14473797,  0.98516489,  0.56308075,  0.83191531,  0.97228128,
        1.20777058,  0.83142994,  0.5480438 ,  0.61779311,  0.77577402,
        0.647412  ,  0.56499849,  0.47013012,  0.32254146,  0.27897635,
       -0.2971822 , -0.21645873]), message=&#39;Optimization terminated successfully&#39;, name_method=&#39;SLSQP&#39;, name_obj=&#39;MLW&#39;)
</pre></div>
</div>
</div>
</div>
<p>Inspect the standardised loadings once the model has been estimated.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your answer here</span>
<span class="n">model</span><span class="o">.</span><span class="n">inspect</span><span class="p">(</span><span class="n">std_est</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>lval</th>
      <th>op</th>
      <th>rval</th>
      <th>Estimate</th>
      <th>Est. Std</th>
      <th>Std. Err</th>
      <th>z-value</th>
      <th>p-value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>GS2</td>
      <td>~</td>
      <td>consistency</td>
      <td>1.000000</td>
      <td>0.600891</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
    </tr>
    <tr>
      <th>1</th>
      <td>GS3</td>
      <td>~</td>
      <td>consistency</td>
      <td>1.093139</td>
      <td>0.605149</td>
      <td>0.034555</td>
      <td>31.635119</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>GS5</td>
      <td>~</td>
      <td>consistency</td>
      <td>1.334372</td>
      <td>0.708305</td>
      <td>0.037746</td>
      <td>35.350948</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>GS7</td>
      <td>~</td>
      <td>consistency</td>
      <td>1.363021</td>
      <td>0.765318</td>
      <td>0.036739</td>
      <td>37.099894</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>GS8</td>
      <td>~</td>
      <td>consistency</td>
      <td>1.429167</td>
      <td>0.743728</td>
      <td>0.039188</td>
      <td>36.469661</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>GS11</td>
      <td>~</td>
      <td>consistency</td>
      <td>0.787414</td>
      <td>0.477832</td>
      <td>0.029994</td>
      <td>26.252075</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>GS1</td>
      <td>~</td>
      <td>perseverance</td>
      <td>1.000000</td>
      <td>0.533688</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
    </tr>
    <tr>
      <th>7</th>
      <td>GS4</td>
      <td>~</td>
      <td>perseverance</td>
      <td>0.850647</td>
      <td>0.378425</td>
      <td>0.041879</td>
      <td>20.312096</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>GS6</td>
      <td>~</td>
      <td>perseverance</td>
      <td>1.391414</td>
      <td>0.704523</td>
      <td>0.04487</td>
      <td>31.010088</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>GS9</td>
      <td>~</td>
      <td>perseverance</td>
      <td>1.495006</td>
      <td>0.700430</td>
      <td>0.048355</td>
      <td>30.917034</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>GS10</td>
      <td>~</td>
      <td>perseverance</td>
      <td>1.558098</td>
      <td>0.609683</td>
      <td>0.054511</td>
      <td>28.583358</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>GS12</td>
      <td>~</td>
      <td>perseverance</td>
      <td>1.345144</td>
      <td>0.687534</td>
      <td>0.043935</td>
      <td>30.616651</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>C1</td>
      <td>~</td>
      <td>conscientious</td>
      <td>1.000000</td>
      <td>0.655445</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
    </tr>
    <tr>
      <th>13</th>
      <td>C2</td>
      <td>~</td>
      <td>conscientious</td>
      <td>-0.949972</td>
      <td>-0.519282</td>
      <td>0.032084</td>
      <td>-29.608911</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>C3</td>
      <td>~</td>
      <td>conscientious</td>
      <td>0.483298</td>
      <td>0.368550</td>
      <td>0.022364</td>
      <td>21.610855</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>C4</td>
      <td>~</td>
      <td>conscientious</td>
      <td>-1.028993</td>
      <td>-0.606177</td>
      <td>0.030377</td>
      <td>-33.873544</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>C5</td>
      <td>~</td>
      <td>conscientious</td>
      <td>1.071902</td>
      <td>0.634088</td>
      <td>0.030469</td>
      <td>35.180123</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>C6</td>
      <td>~</td>
      <td>conscientious</td>
      <td>-1.086823</td>
      <td>-0.581918</td>
      <td>0.033224</td>
      <td>-32.711788</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>C7</td>
      <td>~</td>
      <td>conscientious</td>
      <td>0.768133</td>
      <td>0.507541</td>
      <td>0.026477</td>
      <td>29.011718</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>C8</td>
      <td>~</td>
      <td>conscientious</td>
      <td>-0.810795</td>
      <td>-0.539415</td>
      <td>0.026478</td>
      <td>-30.621825</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>C9</td>
      <td>~</td>
      <td>conscientious</td>
      <td>1.032625</td>
      <td>0.621239</td>
      <td>0.02986</td>
      <td>34.582772</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>21</th>
      <td>C10</td>
      <td>~</td>
      <td>conscientious</td>
      <td>0.656585</td>
      <td>0.485128</td>
      <td>0.023568</td>
      <td>27.858768</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>conscientious</td>
      <td>~~</td>
      <td>conscientious</td>
      <td>0.564998</td>
      <td>1.000000</td>
      <td>0.02512</td>
      <td>22.491832</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>consistency</td>
      <td>~~</td>
      <td>consistency</td>
      <td>0.470130</td>
      <td>1.000000</td>
      <td>0.023369</td>
      <td>20.118005</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>24</th>
      <td>consistency</td>
      <td>~~</td>
      <td>conscientious</td>
      <td>0.322541</td>
      <td>0.625825</td>
      <td>0.013958</td>
      <td>23.108439</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>25</th>
      <td>perseverance</td>
      <td>~~</td>
      <td>perseverance</td>
      <td>0.278976</td>
      <td>1.000000</td>
      <td>0.016152</td>
      <td>17.271673</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>perseverance</td>
      <td>~~</td>
      <td>conscientious</td>
      <td>-0.297182</td>
      <td>-0.748541</td>
      <td>0.012763</td>
      <td>-23.2841</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>27</th>
      <td>perseverance</td>
      <td>~~</td>
      <td>consistency</td>
      <td>-0.216459</td>
      <td>-0.597699</td>
      <td>0.010433</td>
      <td>-20.748451</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>28</th>
      <td>C1</td>
      <td>~~</td>
      <td>C1</td>
      <td>0.750148</td>
      <td>0.570391</td>
      <td>0.018656</td>
      <td>40.209799</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>29</th>
      <td>C10</td>
      <td>~~</td>
      <td>C10</td>
      <td>0.791370</td>
      <td>0.764651</td>
      <td>0.018081</td>
      <td>43.767603</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>30</th>
      <td>C2</td>
      <td>~~</td>
      <td>C2</td>
      <td>1.380990</td>
      <td>0.730346</td>
      <td>0.031909</td>
      <td>43.278811</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>31</th>
      <td>C3</td>
      <td>~~</td>
      <td>C3</td>
      <td>0.839623</td>
      <td>0.864171</td>
      <td>0.018674</td>
      <td>44.963023</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>32</th>
      <td>C4</td>
      <td>~~</td>
      <td>C4</td>
      <td>1.029835</td>
      <td>0.632549</td>
      <td>0.024762</td>
      <td>41.589294</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>33</th>
      <td>C5</td>
      <td>~~</td>
      <td>C5</td>
      <td>0.965405</td>
      <td>0.597932</td>
      <td>0.023629</td>
      <td>40.856773</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>34</th>
      <td>C6</td>
      <td>~~</td>
      <td>C6</td>
      <td>1.303427</td>
      <td>0.661371</td>
      <td>0.030931</td>
      <td>42.139948</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>35</th>
      <td>C7</td>
      <td>~~</td>
      <td>C7</td>
      <td>0.960763</td>
      <td>0.742402</td>
      <td>0.022109</td>
      <td>43.455817</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>36</th>
      <td>C8</td>
      <td>~~</td>
      <td>C8</td>
      <td>0.905083</td>
      <td>0.709031</td>
      <td>0.021073</td>
      <td>42.950893</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>37</th>
      <td>C9</td>
      <td>~~</td>
      <td>C9</td>
      <td>0.958577</td>
      <td>0.614062</td>
      <td>0.023262</td>
      <td>41.208486</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>38</th>
      <td>GS1</td>
      <td>~~</td>
      <td>GS1</td>
      <td>0.700496</td>
      <td>0.715177</td>
      <td>0.016468</td>
      <td>42.535586</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>39</th>
      <td>GS10</td>
      <td>~~</td>
      <td>GS10</td>
      <td>1.144738</td>
      <td>0.628286</td>
      <td>0.028106</td>
      <td>40.72923</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>40</th>
      <td>GS11</td>
      <td>~~</td>
      <td>GS11</td>
      <td>0.985165</td>
      <td>0.771676</td>
      <td>0.022494</td>
      <td>43.796885</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>41</th>
      <td>GS12</td>
      <td>~~</td>
      <td>GS12</td>
      <td>0.563081</td>
      <td>0.527296</td>
      <td>0.014874</td>
      <td>37.856279</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>42</th>
      <td>GS2</td>
      <td>~~</td>
      <td>GS2</td>
      <td>0.831915</td>
      <td>0.638930</td>
      <td>0.020009</td>
      <td>41.577471</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>43</th>
      <td>GS3</td>
      <td>~~</td>
      <td>GS3</td>
      <td>0.972281</td>
      <td>0.633794</td>
      <td>0.023444</td>
      <td>41.472286</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>44</th>
      <td>GS4</td>
      <td>~~</td>
      <td>GS4</td>
      <td>1.207771</td>
      <td>0.856795</td>
      <td>0.027035</td>
      <td>44.673693</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>45</th>
      <td>GS5</td>
      <td>~~</td>
      <td>GS5</td>
      <td>0.831430</td>
      <td>0.498304</td>
      <td>0.021946</td>
      <td>37.885371</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>46</th>
      <td>GS6</td>
      <td>~~</td>
      <td>GS6</td>
      <td>0.548044</td>
      <td>0.503647</td>
      <td>0.014806</td>
      <td>37.014999</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>47</th>
      <td>GS7</td>
      <td>~~</td>
      <td>GS7</td>
      <td>0.617793</td>
      <td>0.414289</td>
      <td>0.017915</td>
      <td>34.485495</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>48</th>
      <td>GS8</td>
      <td>~~</td>
      <td>GS8</td>
      <td>0.775774</td>
      <td>0.446869</td>
      <td>0.021582</td>
      <td>35.945856</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>49</th>
      <td>GS9</td>
      <td>~~</td>
      <td>GS9</td>
      <td>0.647412</td>
      <td>0.509398</td>
      <td>0.017391</td>
      <td>37.226659</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Take a look at the model fit statistics now. What does this suggest to us?</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your answer here</span>
<span class="n">sem</span><span class="o">.</span><span class="n">calc_stats</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DoF</th>
      <th>DoF Baseline</th>
      <th>chi2</th>
      <th>chi2 p-value</th>
      <th>chi2 Baseline</th>
      <th>CFI</th>
      <th>GFI</th>
      <th>AGFI</th>
      <th>NFI</th>
      <th>TLI</th>
      <th>RMSEA</th>
      <th>AIC</th>
      <th>BIC</th>
      <th>LogLik</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Value</th>
      <td>206</td>
      <td>231</td>
      <td>4146.473011</td>
      <td>0.0</td>
      <td>29702.88149</td>
      <td>0.866297</td>
      <td>0.860402</td>
      <td>0.84346</td>
      <td>0.860402</td>
      <td>0.850071</td>
      <td>0.066939</td>
      <td>92.057858</td>
      <td>390.948206</td>
      <td>0.971071</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>What should we conclude? Do these three separate latent factors represent the data well?</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your answer here</span>
<span class="c1"># Not quite! </span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="latent-regressions">
<h1>3. Latent regressions<a class="headerlink" href="#latent-regressions" title="Link to this heading">#</a></h1>
<p>For the final trick, lets expand the last model we made but include an additional part - this time, we’ll use the two grit latent variables to predict the latent conscientiousness score. We’d like to see how well these latent variables can predict conscientiousness. If they are measuring the ‘same’ kind of trait, then we’d expect to see high coefficients for these.</p>
<p>Rebuild the model from question 2 but include an additional part where the two grit latent variables predict laten conscientiousness.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your answer here</span>
<span class="c1"># Model string</span>
<span class="n">mdspec</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">consistency =~ GS2 + GS3 + GS5 + GS7 + GS8 + GS11</span>
<span class="s2">perseverance =~ GS1 + GS4 + GS6 + GS9 + GS10 + GS12</span>
<span class="s2">conscientious =~ C1 + C2 + C3 + C4 + C5 + C6 + C7 + C8 + C9 + C10</span>

<span class="s2">conscientious ~ consistency + perseverance</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="c1"># Create model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">sem</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">mdspec</span><span class="p">)</span>

<span class="c1"># Fit it</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">grit_consc</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SolverResult(fun=0.9710712122615357, success=True, n_it=44, x=array([ 1.09372032,  1.33481513,  1.36326389,  1.42906892,  0.78786201,
        0.8498987 ,  1.3911391 ,  1.4946746 ,  1.55663121,  1.34467594,
       -0.94951483,  0.48329874, -1.02884432,  1.07183657, -1.0865845 ,
        0.768163  , -0.81085453,  1.03271978,  0.65668753,  0.30459112,
       -0.82905879,  0.75009116,  0.79133413,  1.38197185,  0.83954118,
        1.03002355,  0.96546841,  1.30376258,  0.96068456,  0.9050144 ,
        0.95839995,  0.70040618,  1.14535444,  0.98499342,  0.56307038,
        0.83191806,  0.9719378 ,  1.20764937,  0.83116974,  0.54796473,
        0.61777322,  0.7761055 ,  0.64744345,  0.22025482,  0.46986339,
        0.27907538, -0.21635048]), message=&#39;Optimization terminated successfully&#39;, name_method=&#39;SLSQP&#39;, name_obj=&#39;MLW&#39;)
</pre></div>
</div>
</div>
</div>
<p>Once estimated, inspect the coefficients of that latent regression.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your answer here</span>
<span class="n">model</span><span class="o">.</span><span class="n">inspect</span><span class="p">(</span><span class="n">std_est</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>lval</th>
      <th>op</th>
      <th>rval</th>
      <th>Estimate</th>
      <th>Est. Std</th>
      <th>Std. Err</th>
      <th>z-value</th>
      <th>p-value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>conscientious</td>
      <td>~</td>
      <td>consistency</td>
      <td>0.304591</td>
      <td>0.277782</td>
      <td>0.022774</td>
      <td>13.37429</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>conscientious</td>
      <td>~</td>
      <td>perseverance</td>
      <td>-0.829059</td>
      <td>-0.582703</td>
      <td>0.038286</td>
      <td>-21.654358</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>GS2</td>
      <td>~</td>
      <td>consistency</td>
      <td>1.000000</td>
      <td>0.600782</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
    </tr>
    <tr>
      <th>3</th>
      <td>GS3</td>
      <td>~</td>
      <td>consistency</td>
      <td>1.093720</td>
      <td>0.605312</td>
      <td>0.034572</td>
      <td>31.636412</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>GS5</td>
      <td>~</td>
      <td>consistency</td>
      <td>1.334815</td>
      <td>0.708377</td>
      <td>0.037764</td>
      <td>35.346361</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>GS7</td>
      <td>~</td>
      <td>consistency</td>
      <td>1.363264</td>
      <td>0.765289</td>
      <td>0.036755</td>
      <td>37.09102</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>GS8</td>
      <td>~</td>
      <td>consistency</td>
      <td>1.429069</td>
      <td>0.743540</td>
      <td>0.039199</td>
      <td>36.456336</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>GS11</td>
      <td>~</td>
      <td>consistency</td>
      <td>0.787862</td>
      <td>0.477969</td>
      <td>0.030008</td>
      <td>26.255331</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>GS1</td>
      <td>~</td>
      <td>perseverance</td>
      <td>1.000000</td>
      <td>0.533780</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
    </tr>
    <tr>
      <th>9</th>
      <td>GS4</td>
      <td>~</td>
      <td>perseverance</td>
      <td>0.849899</td>
      <td>0.378213</td>
      <td>0.041859</td>
      <td>20.303666</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>GS6</td>
      <td>~</td>
      <td>perseverance</td>
      <td>1.391139</td>
      <td>0.704542</td>
      <td>0.044855</td>
      <td>31.014121</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>GS9</td>
      <td>~</td>
      <td>perseverance</td>
      <td>1.494675</td>
      <td>0.700406</td>
      <td>0.04834</td>
      <td>30.920059</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>GS10</td>
      <td>~</td>
      <td>perseverance</td>
      <td>1.556631</td>
      <td>0.609287</td>
      <td>0.054476</td>
      <td>28.574866</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>GS12</td>
      <td>~</td>
      <td>perseverance</td>
      <td>1.344676</td>
      <td>0.687476</td>
      <td>0.043917</td>
      <td>30.618746</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>C1</td>
      <td>~</td>
      <td>conscientious</td>
      <td>1.000000</td>
      <td>0.655438</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
    </tr>
    <tr>
      <th>15</th>
      <td>C2</td>
      <td>~</td>
      <td>conscientious</td>
      <td>-0.949515</td>
      <td>-0.518943</td>
      <td>0.032088</td>
      <td>-29.591337</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>C3</td>
      <td>~</td>
      <td>conscientious</td>
      <td>0.483299</td>
      <td>0.368548</td>
      <td>0.022364</td>
      <td>21.610512</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>C4</td>
      <td>~</td>
      <td>conscientious</td>
      <td>-1.028844</td>
      <td>-0.606064</td>
      <td>0.030378</td>
      <td>-33.867662</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>C5</td>
      <td>~</td>
      <td>conscientious</td>
      <td>1.071837</td>
      <td>0.634031</td>
      <td>0.03047</td>
      <td>35.176885</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>C6</td>
      <td>~</td>
      <td>conscientious</td>
      <td>-1.086584</td>
      <td>-0.581762</td>
      <td>0.033225</td>
      <td>-32.703737</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>C7</td>
      <td>~</td>
      <td>conscientious</td>
      <td>0.768163</td>
      <td>0.507550</td>
      <td>0.026478</td>
      <td>29.01177</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>21</th>
      <td>C8</td>
      <td>~</td>
      <td>conscientious</td>
      <td>-0.810855</td>
      <td>-0.539436</td>
      <td>0.026479</td>
      <td>-30.622414</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>C9</td>
      <td>~</td>
      <td>conscientious</td>
      <td>1.032720</td>
      <td>0.621287</td>
      <td>0.029861</td>
      <td>34.584457</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>C10</td>
      <td>~</td>
      <td>conscientious</td>
      <td>0.656688</td>
      <td>0.485173</td>
      <td>0.02357</td>
      <td>27.860751</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>24</th>
      <td>conscientious</td>
      <td>~~</td>
      <td>conscientious</td>
      <td>0.220255</td>
      <td>0.389878</td>
      <td>0.011722</td>
      <td>18.790372</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>25</th>
      <td>consistency</td>
      <td>~~</td>
      <td>consistency</td>
      <td>0.469863</td>
      <td>1.000000</td>
      <td>0.023361</td>
      <td>20.113187</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>perseverance</td>
      <td>~~</td>
      <td>perseverance</td>
      <td>0.279075</td>
      <td>1.000000</td>
      <td>0.016155</td>
      <td>17.274642</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>27</th>
      <td>perseverance</td>
      <td>~~</td>
      <td>consistency</td>
      <td>-0.216350</td>
      <td>-0.597463</td>
      <td>0.010429</td>
      <td>-20.744672</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>28</th>
      <td>C1</td>
      <td>~~</td>
      <td>C1</td>
      <td>0.750091</td>
      <td>0.570401</td>
      <td>0.018655</td>
      <td>40.209597</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>29</th>
      <td>C10</td>
      <td>~~</td>
      <td>C10</td>
      <td>0.791334</td>
      <td>0.764607</td>
      <td>0.018081</td>
      <td>43.766842</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>30</th>
      <td>C2</td>
      <td>~~</td>
      <td>C2</td>
      <td>1.381972</td>
      <td>0.730698</td>
      <td>0.031928</td>
      <td>43.283861</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>31</th>
      <td>C3</td>
      <td>~~</td>
      <td>C3</td>
      <td>0.839541</td>
      <td>0.864173</td>
      <td>0.018672</td>
      <td>44.962958</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>32</th>
      <td>C4</td>
      <td>~~</td>
      <td>C4</td>
      <td>1.030024</td>
      <td>0.632686</td>
      <td>0.024765</td>
      <td>41.591692</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>33</th>
      <td>C5</td>
      <td>~~</td>
      <td>C5</td>
      <td>0.965468</td>
      <td>0.598005</td>
      <td>0.02363</td>
      <td>40.858009</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>34</th>
      <td>C6</td>
      <td>~~</td>
      <td>C6</td>
      <td>1.303763</td>
      <td>0.661553</td>
      <td>0.030937</td>
      <td>42.142977</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>35</th>
      <td>C7</td>
      <td>~~</td>
      <td>C7</td>
      <td>0.960685</td>
      <td>0.742393</td>
      <td>0.022107</td>
      <td>43.455503</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>36</th>
      <td>C8</td>
      <td>~~</td>
      <td>C8</td>
      <td>0.905014</td>
      <td>0.709009</td>
      <td>0.021071</td>
      <td>42.950317</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>37</th>
      <td>C9</td>
      <td>~~</td>
      <td>C9</td>
      <td>0.958400</td>
      <td>0.614002</td>
      <td>0.023258</td>
      <td>41.206853</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>38</th>
      <td>GS1</td>
      <td>~~</td>
      <td>GS1</td>
      <td>0.700406</td>
      <td>0.715078</td>
      <td>0.016468</td>
      <td>42.532551</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>39</th>
      <td>GS10</td>
      <td>~~</td>
      <td>GS10</td>
      <td>1.145354</td>
      <td>0.628769</td>
      <td>0.028115</td>
      <td>40.738819</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>40</th>
      <td>GS11</td>
      <td>~~</td>
      <td>GS11</td>
      <td>0.984993</td>
      <td>0.771545</td>
      <td>0.022491</td>
      <td>43.79462</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>41</th>
      <td>GS12</td>
      <td>~~</td>
      <td>GS12</td>
      <td>0.563070</td>
      <td>0.527377</td>
      <td>0.014874</td>
      <td>37.856134</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>42</th>
      <td>GS2</td>
      <td>~~</td>
      <td>GS2</td>
      <td>0.831918</td>
      <td>0.639061</td>
      <td>0.020008</td>
      <td>41.579265</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>43</th>
      <td>GS3</td>
      <td>~~</td>
      <td>GS3</td>
      <td>0.971938</td>
      <td>0.633597</td>
      <td>0.023439</td>
      <td>41.467314</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>44</th>
      <td>GS4</td>
      <td>~~</td>
      <td>GS4</td>
      <td>1.207649</td>
      <td>0.856955</td>
      <td>0.027032</td>
      <td>44.675186</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>45</th>
      <td>GS5</td>
      <td>~~</td>
      <td>GS5</td>
      <td>0.831170</td>
      <td>0.498202</td>
      <td>0.021942</td>
      <td>37.880345</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>46</th>
      <td>GS6</td>
      <td>~~</td>
      <td>GS6</td>
      <td>0.547965</td>
      <td>0.503621</td>
      <td>0.014806</td>
      <td>37.010857</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>47</th>
      <td>GS7</td>
      <td>~~</td>
      <td>GS7</td>
      <td>0.617773</td>
      <td>0.414332</td>
      <td>0.017914</td>
      <td>34.485515</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>48</th>
      <td>GS8</td>
      <td>~~</td>
      <td>GS8</td>
      <td>0.776105</td>
      <td>0.447148</td>
      <td>0.021585</td>
      <td>35.955693</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>49</th>
      <td>GS9</td>
      <td>~~</td>
      <td>GS9</td>
      <td>0.647443</td>
      <td>0.509432</td>
      <td>0.017393</td>
      <td>37.224808</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>By how much does an increase in latent grit alter conscientiousness?</p>
</section>
<section id="testing-the-presence-of-the-big-five-in-big-data">
<h1>4. Testing the presence of the Big Five - in Big Data<a class="headerlink" href="#testing-the-presence-of-the-big-five-in-big-data" title="Link to this heading">#</a></h1>
<p>We’ll now test the presence of the Big Five in a massive dataset of over 1 million respondents! You can find the dataset here: <a class="reference external" href="https://openpsychometrics.org/_rawdata/IPIP-FFM-data-8Nov2018.zip">https://openpsychometrics.org/_rawdata/IPIP-FFM-data-8Nov2018.zip</a></p>
<p>Download it, unzip it, and read in the <code class="docutils literal notranslate"><span class="pre">data-final.csv</span></code> file, which is an enormous dataset containing responses to a Big 5 Questionnaire (the IPIP). These are the questions, the short-hand prefixes showing what trait the question is measuring:</p>
<ul class="simple">
<li><p>EXT1	- I am the life of the party.</p></li>
<li><p>EXT2	- I don’t talk a lot.</p></li>
<li><p>EXT3	- I feel comfortable around people.</p></li>
<li><p>EXT4	- I keep in the background.</p></li>
<li><p>EXT5	- I start conversations.</p></li>
<li><p>EXT6	- I have little to say.</p></li>
<li><p>EXT7	- I talk to a lot of different people at parties.</p></li>
<li><p>EXT8	- I don’t like to draw attention to myself.</p></li>
<li><p>EXT9	- I don’t mind being the center of attention.</p></li>
<li><p>EXT10	- I am quiet around strangers.</p></li>
<li><p>EST1	- I get stressed out easily.</p></li>
<li><p>EST2	- I am relaxed most of the time.</p></li>
<li><p>EST3	- I worry about things.</p></li>
<li><p>EST4	- I seldom feel blue.</p></li>
<li><p>EST5	- I am easily disturbed.</p></li>
<li><p>EST6	- I get upset easily.</p></li>
<li><p>EST7	- I change my mood a lot.</p></li>
<li><p>EST8	- I have frequent mood swings.</p></li>
<li><p>EST9	- I get irritated easily.</p></li>
<li><p>EST10	- I often feel blue.</p></li>
<li><p>AGR1	- I feel little concern for others.</p></li>
<li><p>AGR2	- I am interested in people.</p></li>
<li><p>AGR3	- I insult people.</p></li>
<li><p>AGR4	- I sympathize with others’ feelings.</p></li>
<li><p>AGR5	- I am not interested in other people’s problems.</p></li>
<li><p>AGR6	- I have a soft heart.</p></li>
<li><p>AGR7	- I am not really interested in others.</p></li>
<li><p>AGR8	- I take time out for others.</p></li>
<li><p>AGR9	- I feel others’ emotions.</p></li>
<li><p>AGR10	- I make people feel at ease.</p></li>
<li><p>CSN1	- I am always prepared.</p></li>
<li><p>CSN2	- I leave my belongings around.</p></li>
<li><p>CSN3	- I pay attention to details.</p></li>
<li><p>CSN4	- I make a mess of things.</p></li>
<li><p>CSN5	- I get chores done right away.</p></li>
<li><p>CSN6	- I often forget to put things back in their proper place.</p></li>
<li><p>CSN7	- I like order.</p></li>
<li><p>CSN8	- I shirk my duties.</p></li>
<li><p>CSN9	- I follow a schedule.</p></li>
<li><p>CSN10	- I am exacting in my work.</p></li>
<li><p>OPN1	- I have a rich vocabulary.</p></li>
<li><p>OPN2	- I have difficulty understanding abstract ideas.</p></li>
<li><p>OPN3	- I have a vivid imagination.</p></li>
<li><p>OPN4	- I am not interested in abstract ideas.</p></li>
<li><p>OPN5	- I have excellent ideas.</p></li>
<li><p>OPN6	- I do not have a good imagination.</p></li>
<li><p>OPN7	- I am quick to understand things.</p></li>
<li><p>OPN8	- I use difficult words.</p></li>
<li><p>OPN9	- I spend time reflecting on things.</p></li>
<li><p>OPN10	- I am full of ideas.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your answer here</span>
<span class="n">big5</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data-final.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">big5</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ParserError</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># Your answer here</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">big5</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data-final.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">big5</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="nn">File /opt/miniconda3/envs/py11/lib/python3.11/site-packages/pandas/io/parsers/readers.py:1026,</span> in <span class="ni">read_csv</span><span class="nt">(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, date_format, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, encoding_errors, dialect, on_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options, dtype_backend)</span>
<span class="g g-Whitespace">   </span><span class="mi">1013</span> <span class="n">kwds_defaults</span> <span class="o">=</span> <span class="n">_refine_defaults_read</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1014</span>     <span class="n">dialect</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1015</span>     <span class="n">delimiter</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1022</span>     <span class="n">dtype_backend</span><span class="o">=</span><span class="n">dtype_backend</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1023</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1024</span> <span class="n">kwds</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwds_defaults</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1026</span> <span class="k">return</span> <span class="n">_read</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="n">kwds</span><span class="p">)</span>

<span class="nn">File /opt/miniconda3/envs/py11/lib/python3.11/site-packages/pandas/io/parsers/readers.py:626,</span> in <span class="ni">_read</span><span class="nt">(filepath_or_buffer, kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">623</span>     <span class="k">return</span> <span class="n">parser</span>
<span class="g g-Whitespace">    </span><span class="mi">625</span> <span class="k">with</span> <span class="n">parser</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">626</span>     <span class="k">return</span> <span class="n">parser</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">nrows</span><span class="p">)</span>

<span class="nn">File /opt/miniconda3/envs/py11/lib/python3.11/site-packages/pandas/io/parsers/readers.py:1923,</span> in <span class="ni">TextFileReader.read</span><span class="nt">(self, nrows)</span>
<span class="g g-Whitespace">   </span><span class="mi">1916</span> <span class="n">nrows</span> <span class="o">=</span> <span class="n">validate_integer</span><span class="p">(</span><span class="s2">&quot;nrows&quot;</span><span class="p">,</span> <span class="n">nrows</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1917</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1918</span>     <span class="c1"># error: &quot;ParserBase&quot; has no attribute &quot;read&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1919</span>     <span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1920</span>         <span class="n">index</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1921</span>         <span class="n">columns</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1922</span>         <span class="n">col_dict</span><span class="p">,</span>
<span class="ne">-&gt; </span><span class="mi">1923</span>     <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span><span class="o">.</span><span class="n">read</span><span class="p">(</span>  <span class="c1"># type: ignore[attr-defined]</span>
<span class="g g-Whitespace">   </span><span class="mi">1924</span>         <span class="n">nrows</span>
<span class="g g-Whitespace">   </span><span class="mi">1925</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1926</span> <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1927</span>     <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="nn">File /opt/miniconda3/envs/py11/lib/python3.11/site-packages/pandas/io/parsers/c_parser_wrapper.py:234,</span> in <span class="ni">CParserWrapper.read</span><span class="nt">(self, nrows)</span>
<span class="g g-Whitespace">    </span><span class="mi">232</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">233</span>     <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">low_memory</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">234</span>         <span class="n">chunks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reader</span><span class="o">.</span><span class="n">read_low_memory</span><span class="p">(</span><span class="n">nrows</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">235</span>         <span class="c1"># destructive to chunks</span>
<span class="g g-Whitespace">    </span><span class="mi">236</span>         <span class="n">data</span> <span class="o">=</span> <span class="n">_concatenate_chunks</span><span class="p">(</span><span class="n">chunks</span><span class="p">)</span>

<span class="nn">File parsers.pyx:838,</span> in <span class="ni">pandas._libs.parsers.TextReader.read_low_memory</span><span class="nt">()</span>

<span class="nn">File parsers.pyx:905,</span> in <span class="ni">pandas._libs.parsers.TextReader._read_rows</span><span class="nt">()</span>

<span class="nn">File parsers.pyx:874,</span> in <span class="ni">pandas._libs.parsers.TextReader._tokenize_rows</span><span class="nt">()</span>

<span class="nn">File parsers.pyx:891,</span> in <span class="ni">pandas._libs.parsers.TextReader._check_tokenize_status</span><span class="nt">()</span>

<span class="nn">File parsers.pyx:2061,</span> in <span class="ni">pandas._libs.parsers.raise_parser_error</span><span class="nt">()</span>

<span class="ne">ParserError</span>: Error tokenizing data. C error: Calling read(nbytes) on source failed. Try engine=&#39;python&#39;.
</pre></div>
</div>
</div>
</div>
<p>There are some other columns which can be gotten rid of by running the following code:</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run this to keep only needed columns</span>
<span class="n">big5</span> <span class="o">=</span> <span class="n">big5</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="s1">&#39;[A-Z]\d+&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">~</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;_E&#39;</span><span class="p">)]</span>
<span class="n">big5</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>EXT1</th>
      <th>EXT2</th>
      <th>EXT3</th>
      <th>EXT4</th>
      <th>EXT5</th>
      <th>EXT6</th>
      <th>EXT7</th>
      <th>EXT8</th>
      <th>EXT9</th>
      <th>EXT10</th>
      <th>...</th>
      <th>OPN1</th>
      <th>OPN2</th>
      <th>OPN3</th>
      <th>OPN4</th>
      <th>OPN5</th>
      <th>OPN6</th>
      <th>OPN7</th>
      <th>OPN8</th>
      <th>OPN9</th>
      <th>OPN10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>...</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>...</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>...</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>5.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 50 columns</p>
</div></div></div>
</div>
<p>With the dataset ready, prepare a CFA model that tests whether each of the ten questions load onto their respective latent factor (e.g. EXT1, EXT2 on Extraversion, OPN1, OPN10 onto Openness, and so on).</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your answer here</span>
<span class="c1"># Model string</span>
<span class="n">mdspec</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">extra =~ EXT1 + EXT2 + EXT3 + EXT4 + EXT5 + EXT6 + EXT7 + EXT8 + EXT9 + EXT10</span>
<span class="s2">open =~ OPN1 + OPN2 + OPN3 + OPN4 + OPN5 + OPN6 + OPN7 + OPN8 + OPN9 + OPN10</span>
<span class="s2">consc =~ CSN1 + CSN2 + CSN3 + CSN4 + CSN5 + CSN6 + CSN7 + CSN8 + CSN9 + CSN10</span>
<span class="s2">agree =~ AGR1 + AGR2 + AGR3 + AGR4 + AGR5 + AGR6 + AGR7 + AGR8 + AGR9 + AGR10</span>
<span class="s2">neuro =~ EST1 + EST2 + EST3 + EST4 + EST5 + EST6 + EST7 + EST8 + EST9 + EST10</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="c1"># Create model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">sem</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">mdspec</span><span class="p">)</span>

<span class="c1"># Fit it</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">big5</span><span class="p">)</span> <span class="c1"># EDIT THIS</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SolverResult(fun=5.362960399983457, success=True, n_it=57, x=array([-1.06200145,  0.95417843, -1.030203  ,  1.08329996, -0.81910411,
        1.18386593, -0.80722522,  0.94436833, -1.02606913, -0.86188908,
        0.96142689, -0.74789625,  1.01326436, -0.82631873,  0.78080518,
        1.01344284,  0.62361959,  1.18156628, -1.09149167,  0.5441523 ,
       -1.07460931,  1.11229093, -1.2430879 ,  0.77959885, -0.80312943,
        1.03367876,  0.60953939, -1.12362769,  0.68604513, -1.43895163,
        1.20265913, -1.16395247,  1.14358636, -1.07432794, -1.40957848,
       -0.85553933, -0.65361763,  0.74696009, -0.480897  ,  0.72871028,
        1.06146634,  1.0741923 ,  1.14944716,  0.97562448,  0.94016725,
        1.43674748,  0.90548163,  0.84803146,  1.4625594 ,  0.52875896,
        0.85281192,  1.00831611,  0.78594071,  0.78610704,  0.64851546,
        0.87507333,  0.91986045,  1.32519691,  0.94056273,  0.9785403 ,
        0.99411219,  1.21806196,  0.96280453,  0.97306684,  1.08424766,
        0.9874805 ,  1.02212687,  1.1566158 ,  0.89358005,  1.37933939,
        1.18518101,  0.83121266,  0.72093211,  0.71466859,  0.89804327,
        0.86073212,  0.92737012,  0.92128132,  0.8048323 ,  0.74866263,
        0.76710141,  1.00770347,  0.92762256,  1.13732951,  1.1543183 ,
        0.93733664,  0.50929538,  0.93945862,  0.8324595 ,  0.96393237,
        0.57244287,  0.94478514,  0.77220248,  1.16343713,  0.92790156,
        0.35866303, -0.17700163, -0.06727421,  0.50955039, -0.06273015,
        0.05657929, -0.18473819,  0.04077642,  0.73729111,  0.11323818,
        0.82428062, -0.01288336, -0.1776681 , -0.03575431,  0.40169197]), message=&#39;Optimization terminated successfully&#39;, name_method=&#39;SLSQP&#39;, name_obj=&#39;MLW&#39;)
</pre></div>
</div>
</div>
</div>
<p>Check the model fit statistics:</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your answer here</span>
<span class="n">sem</span><span class="o">.</span><span class="n">calc_stats</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DoF</th>
      <th>DoF Baseline</th>
      <th>chi2</th>
      <th>chi2 p-value</th>
      <th>chi2 Baseline</th>
      <th>CFI</th>
      <th>GFI</th>
      <th>AGFI</th>
      <th>NFI</th>
      <th>TLI</th>
      <th>RMSEA</th>
      <th>AIC</th>
      <th>BIC</th>
      <th>LogLik</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Value</th>
      <td>1165</td>
      <td>1225</td>
      <td>5.445234e+06</td>
      <td>0.0</td>
      <td>1.902557e+07</td>
      <td>0.713837</td>
      <td>0.713794</td>
      <td>0.699054</td>
      <td>0.713794</td>
      <td>0.699099</td>
      <td>0.067841</td>
      <td>209.274079</td>
      <td>1510.654937</td>
      <td>5.36296</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Based on this truly massive dataset, what do we make of the Big 5 model?</p>
</section>
<section id="exploring-and-confirming">
<h1>5. Exploring and confirming<a class="headerlink" href="#exploring-and-confirming" title="Link to this heading">#</a></h1>
<p>For the final exercise, we’ll see how EFA and CFA work together.</p>
<p>The last dataset we’ll see contains a series of scales that researchers thought might measure the ‘DISC’ personality model (see <a class="reference external" href="https://en.wikipedia.org/wiki/DISC_assessment">here</a>), which has four central traits:</p>
<ul class="simple">
<li><p>Dominance: active use of force to overcome resistance in the environment</p></li>
<li><p>Inducement: use of charm in order to deal with obstacles</p></li>
<li><p>Submission: warm and voluntary acceptance of the need to fulfill a request</p></li>
<li><p>Compliance: fearful adjustment to a superior force.</p></li>
</ul>
<p>This model of personality is used in business, but has no real empirical underpinning. To try to address this, researchers took four sub-scale measures from the IPIP, which measure similar-sorts of things - namely, <strong>assertiveness, social confidence, adventurousness, and dominance</strong>.</p>
<p>Our goal now will be to <em>explore</em> a set of latent factors in <em>half</em> of this data, and then <em>confirm</em> it in the other half. Thus, we will use both EFA and CFA.</p>
<p>First, lets read in the data, which is accessible from here: <a class="reference external" href="http://openpsychometrics.org/_rawdata/AS+SC+AD+DO.zip">http://openpsychometrics.org/_rawdata/AS+SC+AD+DO.zip</a></p>
<p>Extract the <code class="docutils literal notranslate"><span class="pre">data.csv</span></code> file and read it in, and show the head. I’ve renamed it <code class="docutils literal notranslate"><span class="pre">data-disc.csv</span></code> my end and read it in with that title.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your answer here</span>
<span class="n">disc</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data-disc.csv&#39;</span><span class="p">)</span>
<span class="n">disc</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AS1</th>
      <th>AS2</th>
      <th>AS3</th>
      <th>AS4</th>
      <th>AS5</th>
      <th>AS6</th>
      <th>AS7</th>
      <th>AS8</th>
      <th>AS9</th>
      <th>AS10</th>
      <th>...</th>
      <th>DO3</th>
      <th>DO4</th>
      <th>DO5</th>
      <th>DO6</th>
      <th>DO7</th>
      <th>DO8</th>
      <th>DO9</th>
      <th>DO10</th>
      <th>age</th>
      <th>gender</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>4</td>
      <td>3</td>
      <td>3</td>
      <td>5</td>
      <td>4</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>2</td>
      <td>5</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>29</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>3</td>
      <td>4</td>
      <td>4</td>
      <td>3</td>
      <td>2</td>
      <td>3</td>
      <td>3</td>
      <td>4</td>
      <td>3</td>
      <td>...</td>
      <td>3</td>
      <td>2</td>
      <td>3</td>
      <td>2</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>49</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>4</td>
      <td>4</td>
      <td>5</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>4</td>
      <td>4</td>
      <td>5</td>
      <td>2</td>
      <td>3</td>
      <td>52</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>3</td>
      <td>3</td>
      <td>4</td>
      <td>3</td>
      <td>4</td>
      <td>1</td>
      <td>...</td>
      <td>3</td>
      <td>3</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>5</td>
      <td>3</td>
      <td>1</td>
      <td>34</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>...</td>
      <td>4</td>
      <td>3</td>
      <td>4</td>
      <td>3</td>
      <td>5</td>
      <td>5</td>
      <td>4</td>
      <td>4</td>
      <td>52</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 42 columns</p>
</div></div></div>
</div>
<p>The column names here represent the four sub-scales, like so:</p>
<ul class="simple">
<li><p><strong>Assertiveness</strong></p>
<ul>
<li><p>AS1 Express myself easily.</p></li>
<li><p>AS2 Try to lead others.</p></li>
<li><p>AS3 Automatically take charge.</p></li>
<li><p>AS4 Know how to convince others.</p></li>
<li><p>AS5 Am the first to act.</p></li>
<li><p>AS6 Take control of things.</p></li>
<li><p>AS7 Wait for others to lead the way.</p></li>
<li><p>AS8 Let others make the decisions.</p></li>
<li><p>AS9 Am not highly motivated to succeed.</p></li>
<li><p>AS10 Can’t come up with new ideas.</p></li>
</ul>
</li>
<li><p><strong>Social Confidence</strong></p>
<ul>
<li><p>SC1 Feel comfortable around people.</p></li>
<li><p>SC2 Don’t mind being the center of attention.</p></li>
<li><p>SC3 Am good at making impromptu speeches.</p></li>
<li><p>SC4 Express myself easily.</p></li>
<li><p>SC5 Have a natural talent for influencing people.</p></li>
<li><p>SC6 Hate being the center of attention.</p></li>
<li><p>SC7 Lack the talent for influencing people.</p></li>
<li><p>SC8 Often feel uncomfortable around others.</p></li>
<li><p>SC9 Don’t like to draw attention to myself.</p></li>
<li><p>SC10 Have little to say.</p></li>
</ul>
</li>
<li><p><strong>Adventurousness</strong></p>
<ul>
<li><p>AD1 Prefer variety to routine.</p></li>
<li><p>AD2 Like to visit new places.</p></li>
<li><p>AD3 Interested in many things.</p></li>
<li><p>AD4 Like to begin new things.</p></li>
<li><p>AD5 Prefer to stick with things that I know.</p></li>
<li><p>AD6 Dislike changes.</p></li>
<li><p>AD7 Don’t like the idea of change.</p></li>
<li><p>AD8 Am a creature of habit.</p></li>
<li><p>AD9 Dislike new foods.</p></li>
<li><p>AD10 Am attached to conventional ways.</p></li>
</ul>
</li>
<li><p><strong>Dominance</strong></p>
<ul>
<li><p>DO1 Try to surpass others’ accomplishments.</p></li>
<li><p>DO2 Try to outdo others.</p></li>
<li><p>DO3 Am quick to correct others.</p></li>
<li><p>DO4 Impose my will on others.</p></li>
<li><p>DO5 Demand explanations from others.</p></li>
<li><p>DO6 Want to control the conversation.</p></li>
<li><p>DO7 Am not afraid of providing criticism.</p></li>
<li><p>DO8 Challenge others’ points of view.</p></li>
<li><p>DO9 Lay down the law to others.</p></li>
<li><p>DO10 Put people under pressure.</p></li>
</ul>
</li>
</ul>
<p>The first task is to prepare the data. Drop the <code class="docutils literal notranslate"><span class="pre">age</span></code> and <code class="docutils literal notranslate"><span class="pre">gender</span></code> columns, and the use the <code class="docutils literal notranslate"><span class="pre">.sample</span></code> dataframe method to extract 50% of the data for exploration and the other half for confirmation. This can be a tricky step, so take care.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your answer here</span>
<span class="c1"># Drop columns</span>
<span class="n">disc</span> <span class="o">=</span> <span class="n">disc</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;gender&#39;</span><span class="p">])</span>

<span class="c1"># Sample half</span>
<span class="n">explore</span> <span class="o">=</span> <span class="n">disc</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mf">.50</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Get the other half not in the first half</span>
<span class="n">confirm</span> <span class="o">=</span> <span class="n">disc</span><span class="p">[</span><span class="o">~</span><span class="n">disc</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">explore</span><span class="o">.</span><span class="n">index</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Fit an EFA to the first half of the data. Lets start with four factors, which would represent the four subscales. What does that solution look like? Fit it and examine a plot of the loadings.</p>
<p>If you want the figure to be larger, you can run the following lines of code before you make a heatmap:
<code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">matplotlib.pyplot</span> <span class="pre">as</span> <span class="pre">plt</span> <span class="pre">plt.figure(figsize=(10,</span> <span class="pre">10))</span></code></p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your answer here</span>
<span class="c1"># EFA</span>
<span class="n">efa</span> <span class="o">=</span> <span class="n">FactorAnalyzer</span><span class="p">(</span><span class="n">n_factors</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">explore</span><span class="p">)</span>

<span class="c1"># Get loadings</span>
<span class="n">loadings</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">efa</span><span class="o">.</span><span class="n">loadings_</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">explore</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">loadings</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Grays&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.2f&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="../_images/0e587843bf8d1480e105a3efa1fc47bb1d07b78dcca6732c27a315b226433073.png" src="../_images/0e587843bf8d1480e105a3efa1fc47bb1d07b78dcca6732c27a315b226433073.png" />
</div>
</div>
<p>We can see immediately that aspects of the Assertiveness and Social Confidence scales align with the first factor, dominance with the second, adventurousness with the third, while some questions in adventurousness (e.g. 1-4) seem to align with the fourth factor. Examine the variance explained next.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your answer here</span>
<span class="n">efa</span><span class="o">.</span><span class="n">get_factor_variance</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([6.4104039 , 4.89054046, 3.33641926, 1.72314879]),
 array([0.1602601 , 0.12226351, 0.08341048, 0.04307872]),
 array([0.1602601 , 0.28252361, 0.36593409, 0.40901281]))
</pre></div>
</div>
</div>
</div>
<p>This explains around 40%, with the most common from the first two factors. Perhaps we could do away with a 4 factor solution and retain a 3 factor one? Fit that below.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your answer here</span>
<span class="c1"># EFA</span>
<span class="n">efa</span> <span class="o">=</span> <span class="n">FactorAnalyzer</span><span class="p">(</span><span class="n">n_factors</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">explore</span><span class="p">)</span>

<span class="c1"># Get loadings</span>
<span class="n">loadings</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">efa</span><span class="o">.</span><span class="n">loadings_</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">explore</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">loadings</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Grays&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.2f&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="../_images/42c2b8db531dbc099acddd565ccf5e5cf01939acd4cc41c6b0dc8d41753d6b90.png" src="../_images/42c2b8db531dbc099acddd565ccf5e5cf01939acd4cc41c6b0dc8d41753d6b90.png" />
</div>
</div>
<p>Examine the variance of this fit.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your answer here</span>
<span class="n">efa</span><span class="o">.</span><span class="n">get_factor_variance</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([6.54110144, 5.0344487 , 3.69496587]),
 array([0.16352754, 0.12586122, 0.09237415]),
 array([0.16352754, 0.28938875, 0.3817629 ]))
</pre></div>
</div>
</div>
</div>
<p>This loses only around 2% variance and has some more informative factors. We’ll then say there are three factors underpinning this four-questionnaire test. The first captures Assertiveness and Social Confidence, the second dominance, and the third adventurousness.</p>
<p>Now, how might we translate this setup into a CFA model that we can test on the other half of the data?</p>
<p>One straightforward way would be to use a coarse measure as just described above - that is, <em>all</em> questions for assertiveness and social confidence go on one factor, all dominance questions on another, and all adventurousness questions on the final one.</p>
<p>Build that below, but using the other slice of the data to confirm whether this structure ‘holds’. Check the fit statistics.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your answer here</span>
<span class="c1"># Model string</span>
<span class="n">mdspec</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">latent1 =~ AS1 + AS2 + AS3 + AS4 + AS5 + AS6 + AS7 + AS8 + AS9 + AS10 + SC1 + SC2 + SC3 + SC4 + SC5 + SC6 + SC7 + SC8 + SC9 + SC10</span>
<span class="s2">latent2 =~ DO1 + DO2 + DO3 + DO4 + DO5 + DO6 + DO7 + DO8 + DO9 + DO10</span>
<span class="s2">latent3 =~ AD1 + AD2 + AD3 + AD4 + AD5 + AD6 + AD7 + AD8 + AD9 + AD10</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="c1"># Create model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">sem</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">mdspec</span><span class="p">)</span>

<span class="c1"># Fit it</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">confirm</span><span class="p">)</span> 

<span class="c1"># Fit statistics</span>
<span class="n">sem</span><span class="o">.</span><span class="n">calc_stats</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DoF</th>
      <th>DoF Baseline</th>
      <th>chi2</th>
      <th>chi2 p-value</th>
      <th>chi2 Baseline</th>
      <th>CFI</th>
      <th>GFI</th>
      <th>AGFI</th>
      <th>NFI</th>
      <th>TLI</th>
      <th>RMSEA</th>
      <th>AIC</th>
      <th>BIC</th>
      <th>LogLik</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Value</th>
      <td>737</td>
      <td>780</td>
      <td>4041.373173</td>
      <td>0.0</td>
      <td>9776.734335</td>
      <td>0.632714</td>
      <td>0.586634</td>
      <td>0.562516</td>
      <td>0.586634</td>
      <td>0.611285</td>
      <td>0.094506</td>
      <td>149.930922</td>
      <td>500.239906</td>
      <td>8.034539</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>That does not look great! Inspect whether the individual coefficients are associated in the way we’d expect:</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your answer here</span>
<span class="n">model</span><span class="o">.</span><span class="n">inspect</span><span class="p">(</span><span class="n">std_est</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;op == &quot;~&quot;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>lval</th>
      <th>op</th>
      <th>rval</th>
      <th>Estimate</th>
      <th>Est. Std</th>
      <th>Std. Err</th>
      <th>z-value</th>
      <th>p-value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AS1</td>
      <td>~</td>
      <td>latent1</td>
      <td>1.000000</td>
      <td>0.704852</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AS2</td>
      <td>~</td>
      <td>latent1</td>
      <td>0.818380</td>
      <td>0.609185</td>
      <td>0.063324</td>
      <td>12.923657</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AS3</td>
      <td>~</td>
      <td>latent1</td>
      <td>0.826251</td>
      <td>0.596697</td>
      <td>0.065244</td>
      <td>12.664005</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AS4</td>
      <td>~</td>
      <td>latent1</td>
      <td>0.803585</td>
      <td>0.645872</td>
      <td>0.058724</td>
      <td>13.68413</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AS5</td>
      <td>~</td>
      <td>latent1</td>
      <td>0.668898</td>
      <td>0.496057</td>
      <td>0.063347</td>
      <td>10.559247</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>AS6</td>
      <td>~</td>
      <td>latent1</td>
      <td>0.621050</td>
      <td>0.471490</td>
      <td>0.061842</td>
      <td>10.042551</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>AS7</td>
      <td>~</td>
      <td>latent1</td>
      <td>-0.679325</td>
      <td>-0.518800</td>
      <td>0.061552</td>
      <td>-11.036618</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>AS8</td>
      <td>~</td>
      <td>latent1</td>
      <td>-0.452216</td>
      <td>-0.344830</td>
      <td>0.061406</td>
      <td>-7.364376</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>AS9</td>
      <td>~</td>
      <td>latent1</td>
      <td>-0.400243</td>
      <td>-0.269313</td>
      <td>0.069506</td>
      <td>-5.758391</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>AS10</td>
      <td>~</td>
      <td>latent1</td>
      <td>-0.311342</td>
      <td>-0.229752</td>
      <td>0.063346</td>
      <td>-4.914959</td>
      <td>0.000001</td>
    </tr>
    <tr>
      <th>10</th>
      <td>SC1</td>
      <td>~</td>
      <td>latent1</td>
      <td>0.894873</td>
      <td>0.589880</td>
      <td>0.071463</td>
      <td>12.522108</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>SC2</td>
      <td>~</td>
      <td>latent1</td>
      <td>1.086737</td>
      <td>0.657465</td>
      <td>0.07805</td>
      <td>13.923668</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>SC3</td>
      <td>~</td>
      <td>latent1</td>
      <td>1.029209</td>
      <td>0.600678</td>
      <td>0.080742</td>
      <td>12.746809</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>SC4</td>
      <td>~</td>
      <td>latent1</td>
      <td>0.957403</td>
      <td>0.651346</td>
      <td>0.069391</td>
      <td>13.797292</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>SC5</td>
      <td>~</td>
      <td>latent1</td>
      <td>0.890399</td>
      <td>0.631887</td>
      <td>0.066474</td>
      <td>13.394672</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>SC6</td>
      <td>~</td>
      <td>latent1</td>
      <td>-0.957331</td>
      <td>-0.614929</td>
      <td>0.073398</td>
      <td>-13.042958</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>SC7</td>
      <td>~</td>
      <td>latent1</td>
      <td>-0.773334</td>
      <td>-0.599738</td>
      <td>0.060762</td>
      <td>-12.727266</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>SC8</td>
      <td>~</td>
      <td>latent1</td>
      <td>-0.874095</td>
      <td>-0.579628</td>
      <td>0.071015</td>
      <td>-12.30852</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>SC9</td>
      <td>~</td>
      <td>latent1</td>
      <td>-0.910533</td>
      <td>-0.601252</td>
      <td>0.071365</td>
      <td>-12.758753</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>SC10</td>
      <td>~</td>
      <td>latent1</td>
      <td>-0.769383</td>
      <td>-0.533247</td>
      <td>0.067851</td>
      <td>-11.33938</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>DO1</td>
      <td>~</td>
      <td>latent2</td>
      <td>1.000000</td>
      <td>0.538283</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
    </tr>
    <tr>
      <th>21</th>
      <td>DO2</td>
      <td>~</td>
      <td>latent2</td>
      <td>1.142825</td>
      <td>0.592763</td>
      <td>0.113915</td>
      <td>10.032241</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>DO3</td>
      <td>~</td>
      <td>latent2</td>
      <td>1.144616</td>
      <td>0.666074</td>
      <td>0.106152</td>
      <td>10.782812</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>DO4</td>
      <td>~</td>
      <td>latent2</td>
      <td>1.285773</td>
      <td>0.744064</td>
      <td>0.112106</td>
      <td>11.46927</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>24</th>
      <td>DO5</td>
      <td>~</td>
      <td>latent2</td>
      <td>1.282494</td>
      <td>0.688627</td>
      <td>0.116664</td>
      <td>10.99304</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>25</th>
      <td>DO6</td>
      <td>~</td>
      <td>latent2</td>
      <td>1.035638</td>
      <td>0.610491</td>
      <td>0.101301</td>
      <td>10.223355</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>DO7</td>
      <td>~</td>
      <td>latent2</td>
      <td>0.996247</td>
      <td>0.571367</td>
      <td>0.101729</td>
      <td>9.793166</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>27</th>
      <td>DO8</td>
      <td>~</td>
      <td>latent2</td>
      <td>0.957089</td>
      <td>0.598186</td>
      <td>0.094842</td>
      <td>10.09137</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>28</th>
      <td>DO9</td>
      <td>~</td>
      <td>latent2</td>
      <td>1.040693</td>
      <td>0.604591</td>
      <td>0.102426</td>
      <td>10.160443</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>29</th>
      <td>DO10</td>
      <td>~</td>
      <td>latent2</td>
      <td>1.177656</td>
      <td>0.670289</td>
      <td>0.108812</td>
      <td>10.822828</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>30</th>
      <td>AD1</td>
      <td>~</td>
      <td>latent3</td>
      <td>1.000000</td>
      <td>0.478837</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
    </tr>
    <tr>
      <th>31</th>
      <td>AD2</td>
      <td>~</td>
      <td>latent3</td>
      <td>0.596162</td>
      <td>0.342152</td>
      <td>0.094078</td>
      <td>6.336898</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>32</th>
      <td>AD3</td>
      <td>~</td>
      <td>latent3</td>
      <td>0.437053</td>
      <td>0.268654</td>
      <td>0.084017</td>
      <td>5.201967</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>33</th>
      <td>AD4</td>
      <td>~</td>
      <td>latent3</td>
      <td>0.769467</td>
      <td>0.427006</td>
      <td>0.103145</td>
      <td>7.460015</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>34</th>
      <td>AD5</td>
      <td>~</td>
      <td>latent3</td>
      <td>-1.349486</td>
      <td>-0.698710</td>
      <td>0.13627</td>
      <td>-9.902998</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>35</th>
      <td>AD6</td>
      <td>~</td>
      <td>latent3</td>
      <td>-1.606016</td>
      <td>-0.819433</td>
      <td>0.152228</td>
      <td>-10.550087</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>36</th>
      <td>AD7</td>
      <td>~</td>
      <td>latent3</td>
      <td>-1.390536</td>
      <td>-0.778319</td>
      <td>0.134248</td>
      <td>-10.357974</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>37</th>
      <td>AD8</td>
      <td>~</td>
      <td>latent3</td>
      <td>-1.274979</td>
      <td>-0.643348</td>
      <td>0.133857</td>
      <td>-9.524967</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>38</th>
      <td>AD9</td>
      <td>~</td>
      <td>latent3</td>
      <td>-0.792595</td>
      <td>-0.407009</td>
      <td>0.109885</td>
      <td>-7.212967</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>39</th>
      <td>AD10</td>
      <td>~</td>
      <td>latent3</td>
      <td>-1.226555</td>
      <td>-0.634494</td>
      <td>0.129663</td>
      <td>-9.459547</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>These seem to match the pattern seen in the loadings, broadly, but our model fit suggests this is not good. As a final push, we could consider trying to reflect the loadings we saw from EFA more closely. From the loadings matrix we can actually discern which factor each question had the highest affinity with by using the <code class="docutils literal notranslate"><span class="pre">.idxmax(axis='columns')</span></code> command, like so:</p>
<p><code class="docutils literal notranslate"><span class="pre">loadings.idxmax(axis='columns')</span></code></p>
<p>Run that below and examine the output.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># You answer here</span>
<span class="n">loadings</span><span class="o">.</span><span class="n">idxmax</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AS1     0
AS2     0
AS3     1
AS4     0
AS5     1
AS6     1
AS7     2
AS8     2
AS9     2
AS10    2
SC1     0
SC2     0
SC3     0
SC4     0
SC5     0
SC6     1
SC7     2
SC8     1
SC9     1
SC10    2
AD1     1
AD2     0
AD3     1
AD4     1
AD5     2
AD6     2
AD7     2
AD8     2
AD9     2
AD10    2
DO1     1
DO2     1
DO3     1
DO4     1
DO5     1
DO6     1
DO7     1
DO8     1
DO9     1
DO10    1
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>What is interesting here is that reveals a rather disparate pattern for the assertiveness scale. Some questions loading on factor 0 (the first) while others are more associated with the second factor, which was related to dominance. Consider AS3 - “automatically take charge”. Should we be surprised this is more closely associated with a different factor? We can try to recreate this by tying each question as shown above to a specific factor. This is a tricky process. See if you can build this model below and examnine its fit statistic. It will more closely resemble the EFA, and may emerge as a better model.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your answer here</span>
<span class="n">mdspec</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">latent1 =~ AS1 + AS2 + AS4 + SC1 + SC2 + SC3 + SC4 + SC5 + AD2</span>
<span class="s2">latent2 =~ DO1 + DO2 + DO3 + DO4 + DO5 + DO6 + DO7 + DO8 + DO9 + DO10 + AS3 + AS5 + AS6 + SC6 + SC8 + SC9 + AD1 + AD3 + AD4</span>
<span class="s2">latent3 =~ AS7 + AS8 + AS9 + AS10 + SC7 + SC10 + AD5 + AD6 + AD7 + AD8 + AD9 + AD10</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="c1"># Create model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">sem</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">mdspec</span><span class="p">)</span>

<span class="c1"># Fit it</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">confirm</span><span class="p">)</span> 

<span class="c1"># Fit statistics</span>
<span class="n">sem</span><span class="o">.</span><span class="n">calc_stats</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DoF</th>
      <th>DoF Baseline</th>
      <th>chi2</th>
      <th>chi2 p-value</th>
      <th>chi2 Baseline</th>
      <th>CFI</th>
      <th>GFI</th>
      <th>AGFI</th>
      <th>NFI</th>
      <th>TLI</th>
      <th>RMSEA</th>
      <th>AIC</th>
      <th>BIC</th>
      <th>LogLik</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Value</th>
      <td>737</td>
      <td>780</td>
      <td>4906.10706</td>
      <td>0.0</td>
      <td>9776.734335</td>
      <td>0.536598</td>
      <td>0.498185</td>
      <td>0.468907</td>
      <td>0.498185</td>
      <td>0.509561</td>
      <td>0.106154</td>
      <td>146.492616</td>
      <td>496.8016</td>
      <td>9.753692</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Amusingly, this is <em>even worse</em>. Despite our best efforts, we’re unable to create a solid, stable set of latent variables that underpin this collection of data. This is a common experience, and the field of psychology has numerous measurement issues to which poor latent factor models contribute. Nonetheless, EFA and CFA are incredibly powerful approaches but they need to be treated with a lot of circumspection.</p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./9_CFA"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="QPoP%20-%20Week%209%20Workshop.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">9 - Confirmatory Factor Analysis</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Fitting latent variables onto data - Exercises &amp; Answers</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#grit-revisited-are-we-sure-its-there">1. Grit revisited - are we <em>sure</em> its there?</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#important">Important</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#building-a-latent-factor-model-of-grit">Building a latent factor model of grit</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#grit-and-conscientiousness">2. Grit and conscientiousness</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#latent-regressions">3. Latent regressions</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#testing-the-presence-of-the-big-five-in-big-data">4. Testing the presence of the Big Five - in Big Data</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#exploring-and-confirming">5. Exploring and confirming</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Alex Jones, Ph.D
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>